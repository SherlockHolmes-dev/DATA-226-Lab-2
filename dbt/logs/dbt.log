[0m15:20:13.399820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de3cb0>]}


============================== 15:20:13.401559 | 9096f604-f903-4ffc-a55d-e3e5ff472cd5 ==============================
[0m15:20:13.401559 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:20:13.401878 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'profiles_dir': '/Users/parthmodi/.dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True'}
[0m15:20:14.377455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9096f604-f903-4ffc-a55d-e3e5ff472cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de2390>]}
[0m15:20:14.400390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9096f604-f903-4ffc-a55d-e3e5ff472cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13988c170>]}
[0m15:20:14.401013 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:20:14.429115 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:20:14.429802 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:20:14.430023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9096f604-f903-4ffc-a55d-e3e5ff472cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e1fb00>]}
[0m15:20:14.934038 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.elt.output
[0m15:20:14.938963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9096f604-f903-4ffc-a55d-e3e5ff472cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a1654f0>]}
[0m15:20:15.020773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9096f604-f903-4ffc-a55d-e3e5ff472cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c103ef0>]}
[0m15:20:15.021059 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m15:20:15.021224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9096f604-f903-4ffc-a55d-e3e5ff472cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13be24f20>]}
[0m15:20:15.021914 [info ] [MainThread]: 
[0m15:20:15.022195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:20:15.022410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9096f604-f903-4ffc-a55d-e3e5ff472cd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c21bc20>]}
[0m15:20:15.022616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:15.022741 [info ] [MainThread]: 
[0m15:20:15.024118 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m15:20:15.024333 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.elt.trip_data'
[0m15:20:15.024487 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m15:20:15.027871 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m15:20:15.028528 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m15:20:15.029046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:15.029214 [debug] [MainThread]: Connection 'model.elt.trip_data' was properly closed.
[0m15:20:15.029352 [info ] [MainThread]: 
[0m15:20:15.029490 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m15:20:15.029700 [debug] [MainThread]: Command end result
[0m15:20:15.043362 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6978097, "process_user_time": 2.666454, "process_kernel_time": 0.974945, "process_mem_max_rss": "188301312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:20:15.043615 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:15.043572 after 1.70 seconds
[0m15:20:15.043776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139b552b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139dab230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139dab1d0>]}
[0m15:20:15.043926 [debug] [MainThread]: Flushing usage events
[0m15:25:08.441650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ffc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ffb90>]}


============================== 15:25:08.443517 | 2c836264-125c-4df1-b79b-cd1e1d8cc5e3 ==============================
[0m15:25:08.443517 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:25:08.443849 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/parthmodi/.dbt', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None'}
[0m15:25:09.411834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c836264-125c-4df1-b79b-cd1e1d8cc5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d7cad0>]}
[0m15:25:09.434889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c836264-125c-4df1-b79b-cd1e1d8cc5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9d66f0>]}
[0m15:25:09.435479 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:25:09.446846 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:25:09.526566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:25:09.526882 [debug] [MainThread]: Partial parsing: added file: elt://models/output/trip_summary_table.sql
[0m15:25:09.527093 [debug] [MainThread]: Partial parsing: updated file: elt://models/source.yml
[0m15:25:09.669374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c836264-125c-4df1-b79b-cd1e1d8cc5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c96e1b0>]}
[0m15:25:09.711977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c836264-125c-4df1-b79b-cd1e1d8cc5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c95be00>]}
[0m15:25:09.712254 [info ] [MainThread]: Found 2 models, 2 sources, 459 macros
[0m15:25:09.712424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c836264-125c-4df1-b79b-cd1e1d8cc5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c969070>]}
[0m15:25:09.713168 [info ] [MainThread]: 
[0m15:25:09.713466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:09.713895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m15:25:09.719992 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m15:25:09.720168 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m15:25:09.720302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:10.807578 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.087 seconds
[0m15:25:10.812420 [debug] [ThreadPool]: On list_dev: Close
[0m15:25:10.960984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m15:25:10.970192 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:25:10.970603 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:25:10.970840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:11.583668 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.612 seconds
[0m15:25:11.587957 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:25:11.746914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c836264-125c-4df1-b79b-cd1e1d8cc5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c9c3da0>]}
[0m15:25:11.748194 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:11.748788 [info ] [MainThread]: 
[0m15:25:11.753406 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m15:25:11.754134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m15:25:11.754627 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m15:25:11.764834 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m15:25:11.766028 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m15:25:11.766837 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m15:25:11.767671 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m15:25:11.768243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.trip_summary_table)
[0m15:25:11.768658 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m15:25:11.776852 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m15:25:11.777698 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m15:25:11.802671 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m15:25:11.804112 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m15:25:11.804388 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour
ORDER BY
    trip_hour;
[0m15:25:11.804632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:12.428561 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b84f3d-0004-26ad-0002-587f000100fa
[0m15:25:12.429239 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 13 unexpected ';'.
[0m15:25:12.429833 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m15:25:12.577402 [debug] [Thread-1 (]: Database Error in model trip_summary_table (models/output/trip_summary_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 13 unexpected ';'.
  compiled code at target/run/elt/models/output/trip_summary_table.sql
[0m15:25:12.579640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c836264-125c-4df1-b79b-cd1e1d8cc5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108764c80>]}
[0m15:25:12.580608 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.trip_summary_table ............. [[31mERROR[0m in 0.81s]
[0m15:25:12.581450 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m15:25:12.582969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:12.583359 [debug] [MainThread]: Connection 'model.elt.trip_summary_table' was properly closed.
[0m15:25:12.583720 [info ] [MainThread]: 
[0m15:25:12.584105 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m15:25:12.584891 [debug] [MainThread]: Command end result
[0m15:25:12.614292 [info ] [MainThread]: 
[0m15:25:12.614717 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:25:12.614958 [info ] [MainThread]: 
[0m15:25:12.615285 [error] [MainThread]:   Database Error in model trip_summary_table (models/output/trip_summary_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 13 unexpected ';'.
  compiled code at target/run/elt/models/output/trip_summary_table.sql
[0m15:25:12.615514 [info ] [MainThread]: 
[0m15:25:12.615776 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:25:12.618782 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.229786, "process_user_time": 2.821262, "process_kernel_time": 0.957505, "process_mem_max_rss": "200327168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:25:12.619275 [debug] [MainThread]: Command `dbt run` failed at 15:25:12.619197 after 4.23 seconds
[0m15:25:12.619591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c817c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917be60>]}
[0m15:25:12.619861 [debug] [MainThread]: Flushing usage events
[0m15:25:36.026148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566bc80>]}


============================== 15:25:36.028032 | 59c7f248-edf8-44e1-b7a7-bec3ae3331e7 ==============================
[0m15:25:36.028032 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:25:36.028370 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'profiles_dir': '/Users/parthmodi/.dbt', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'cache_selected_only': 'False', 'version_check': 'True', 'quiet': 'False'}
[0m15:25:37.684401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59c7f248-edf8-44e1-b7a7-bec3ae3331e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cba6720>]}
[0m15:25:37.707366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59c7f248-edf8-44e1-b7a7-bec3ae3331e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7ec0>]}
[0m15:25:37.708008 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:25:37.719028 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:25:37.798990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:37.799332 [debug] [MainThread]: Partial parsing: updated file: elt://models/output/trip_summary_table.sql
[0m15:25:37.904599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59c7f248-edf8-44e1-b7a7-bec3ae3331e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130982000>]}
[0m15:25:37.945585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59c7f248-edf8-44e1-b7a7-bec3ae3331e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130b73890>]}
[0m15:25:37.945860 [info ] [MainThread]: Found 2 models, 2 sources, 459 macros
[0m15:25:37.946026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59c7f248-edf8-44e1-b7a7-bec3ae3331e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13084b8c0>]}
[0m15:25:37.946768 [info ] [MainThread]: 
[0m15:25:37.947068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:37.947475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m15:25:37.953759 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m15:25:37.953925 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m15:25:37.954055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:38.652105 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.698 seconds
[0m15:25:38.655970 [debug] [ThreadPool]: On list_dev: Close
[0m15:25:38.796889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m15:25:38.811961 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:25:38.812537 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:25:38.812879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:39.462083 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.649 seconds
[0m15:25:39.467029 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:25:39.608013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59c7f248-edf8-44e1-b7a7-bec3ae3331e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130748680>]}
[0m15:25:39.609680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:39.610192 [info ] [MainThread]: 
[0m15:25:39.614903 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m15:25:39.615614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m15:25:39.616109 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m15:25:39.626337 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m15:25:39.627448 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m15:25:39.628193 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m15:25:39.628938 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m15:25:39.629570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.trip_summary_table)
[0m15:25:39.629991 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m15:25:39.638052 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m15:25:39.638767 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m15:25:39.663719 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m15:25:39.664874 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m15:25:39.665142 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour
ORDER BY
    trip_hour
        );
[0m15:25:39.665376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:46.374798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.709 seconds
[0m15:25:46.408764 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m15:25:46.590141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c7f248-edf8-44e1-b7a7-bec3ae3331e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1305d64b0>]}
[0m15:25:46.591417 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 6.96s]
[0m15:25:46.592135 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m15:25:46.593366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:46.593701 [debug] [MainThread]: Connection 'model.elt.trip_summary_table' was properly closed.
[0m15:25:46.594005 [info ] [MainThread]: 
[0m15:25:46.594333 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m15:25:46.595003 [debug] [MainThread]: Command end result
[0m15:25:46.622466 [info ] [MainThread]: 
[0m15:25:46.622852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:46.623094 [info ] [MainThread]: 
[0m15:25:46.623340 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:25:46.626816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.650375, "process_user_time": 2.376506, "process_kernel_time": 1.358787, "process_mem_max_rss": "197410816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:25:46.627288 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:46.627213 after 10.65 seconds
[0m15:25:46.627598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7fe0>]}
[0m15:25:46.627862 [debug] [MainThread]: Flushing usage events
[0m15:29:53.326683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c924e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108183cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108183bc0>]}


============================== 15:29:53.328536 | e08ade09-e4d9-49b5-9bfc-170e817c6efc ==============================
[0m15:29:53.328536 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:29:53.328865 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': '/Users/parthmodi/.dbt', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False'}
[0m15:29:54.291414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e08ade09-e4d9-49b5-9bfc-170e817c6efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109208fb0>]}
[0m15:29:54.314416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e08ade09-e4d9-49b5-9bfc-170e817c6efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12117f950>]}
[0m15:29:54.314986 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:29:54.326478 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:29:54.406279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:29:54.406584 [debug] [MainThread]: Partial parsing: added file: elt://models/output/user_demographic_table.sql
[0m15:29:54.406796 [debug] [MainThread]: Partial parsing: updated file: elt://models/source.yml
[0m15:29:54.548029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e08ade09-e4d9-49b5-9bfc-170e817c6efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220eab10>]}
[0m15:29:54.591632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e08ade09-e4d9-49b5-9bfc-170e817c6efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220a8890>]}
[0m15:29:54.591912 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m15:29:54.592087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e08ade09-e4d9-49b5-9bfc-170e817c6efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923e540>]}
[0m15:29:54.592876 [info ] [MainThread]: 
[0m15:29:54.593177 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:54.595206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m15:29:54.601312 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m15:29:54.601486 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m15:29:54.601619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:55.200825 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.599 seconds
[0m15:29:55.205698 [debug] [ThreadPool]: On list_dev: Close
[0m15:29:55.380968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m15:29:55.394840 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:29:55.395293 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:29:55.395649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:56.013524 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.617 seconds
[0m15:29:56.017904 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:29:56.174398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e08ade09-e4d9-49b5-9bfc-170e817c6efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb4a40>]}
[0m15:29:56.175846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:56.176520 [info ] [MainThread]: 
[0m15:29:56.179792 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m15:29:56.180375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m15:29:56.180813 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m15:29:56.190987 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m15:29:56.192199 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m15:29:56.193007 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m15:29:56.193585 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m15:29:56.194078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.trip_summary_table)
[0m15:29:56.194448 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m15:29:56.203303 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m15:29:56.204055 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m15:29:56.228582 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m15:29:56.229936 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m15:29:56.230213 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour
ORDER BY
    trip_hour
        );
[0m15:29:56.230460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:02.071176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.840 seconds
[0m15:30:02.103711 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m15:30:02.276479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e08ade09-e4d9-49b5-9bfc-170e817c6efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ad2180>]}
[0m15:30:02.278206 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 6.08s]
[0m15:30:02.279117 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m15:30:02.279712 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m15:30:02.280477 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.user_demographic_table .................. [RUN]
[0m15:30:02.281204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m15:30:02.281727 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m15:30:02.291110 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m15:30:02.292093 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m15:30:02.294517 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m15:30:02.295867 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m15:30:02.296300 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other'),
    COUNT(*) AS trip_count,
    AVG(birth_year) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count
FROM 
    __dbt__cte__trip_data
GROUP BY 
    usertype
        );
[0m15:30:02.296705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:02.977026 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b84f42-0004-26aa-0002-587f0001112e
[0m15:30:02.977714 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m15:30:02.978309 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m15:30:03.116502 [debug] [Thread-1 (]: Database Error in model user_demographic_table (models/output/user_demographic_table.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/elt/models/output/user_demographic_table.sql
[0m15:30:03.117426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e08ade09-e4d9-49b5-9bfc-170e817c6efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12225f650>]}
[0m15:30:03.118343 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model analytics.user_demographic_table ......... [[31mERROR[0m in 0.84s]
[0m15:30:03.119137 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m15:30:03.120697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:03.121209 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m15:30:03.121715 [info ] [MainThread]: 
[0m15:30:03.122152 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m15:30:03.123203 [debug] [MainThread]: Command end result
[0m15:30:03.154072 [info ] [MainThread]: 
[0m15:30:03.154462 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:30:03.154712 [info ] [MainThread]: 
[0m15:30:03.155022 [error] [MainThread]:   Database Error in model user_demographic_table (models/output/user_demographic_table.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/elt/models/output/user_demographic_table.sql
[0m15:30:03.155259 [info ] [MainThread]: 
[0m15:30:03.155510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:30:03.158629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.8853855, "process_user_time": 2.982577, "process_kernel_time": 0.770992, "process_mem_max_rss": "199311360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:30:03.159122 [debug] [MainThread]: Command `dbt run` failed at 15:30:03.159052 after 9.89 seconds
[0m15:30:03.159467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923c230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c93260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c928a0>]}
[0m15:30:03.159749 [debug] [MainThread]: Flushing usage events
[0m15:33:24.601999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108824ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7bc20>]}


============================== 15:33:24.604008 | 00a92c73-173a-4451-822f-5d2df138f430 ==============================
[0m15:33:24.604008 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:33:24.604341 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'log_format': 'default', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'profiles_dir': '/Users/parthmodi/.dbt', 'use_experimental_parser': 'False', 'debug': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m15:33:25.558040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00a92c73-173a-4451-822f-5d2df138f430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f77bf80>]}
[0m15:33:25.581172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00a92c73-173a-4451-822f-5d2df138f430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108827500>]}
[0m15:33:25.581804 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:33:25.593519 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:33:25.673155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:25.673482 [debug] [MainThread]: Partial parsing: updated file: elt://models/output/user_demographic_table.sql
[0m15:33:25.780007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00a92c73-173a-4451-822f-5d2df138f430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123aad520>]}
[0m15:33:25.822483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00a92c73-173a-4451-822f-5d2df138f430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a97260>]}
[0m15:33:25.822768 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m15:33:25.822935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00a92c73-173a-4451-822f-5d2df138f430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123aad280>]}
[0m15:33:25.823722 [info ] [MainThread]: 
[0m15:33:25.824003 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:25.826000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m15:33:25.832325 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m15:33:25.832504 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m15:33:25.832640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:26.624081 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.791 seconds
[0m15:33:26.627113 [debug] [ThreadPool]: On list_dev: Close
[0m15:33:26.792125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m15:33:26.806013 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:33:26.806492 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:33:26.806835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:27.353118 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.546 seconds
[0m15:33:27.357806 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:33:27.503849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00a92c73-173a-4451-822f-5d2df138f430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b0920>]}
[0m15:33:27.504785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:27.505243 [info ] [MainThread]: 
[0m15:33:27.508407 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m15:33:27.509196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m15:33:27.509785 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m15:33:27.520543 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m15:33:27.522058 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m15:33:27.522959 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m15:33:27.523633 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m15:33:27.524202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.trip_summary_table)
[0m15:33:27.524585 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m15:33:27.533080 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m15:33:27.534115 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m15:33:27.560189 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m15:33:27.561839 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m15:33:27.562137 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour
ORDER BY
    trip_hour
        );
[0m15:33:27.562378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:33.120531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.558 seconds
[0m15:33:33.153810 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m15:33:33.280696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00a92c73-173a-4451-822f-5d2df138f430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205d6360>]}
[0m15:33:33.282296 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 5.75s]
[0m15:33:33.283512 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m15:33:33.284154 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m15:33:33.284964 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.user_demographic_table .................. [RUN]
[0m15:33:33.285684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m15:33:33.286199 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m15:33:33.296304 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m15:33:33.298278 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m15:33:33.300962 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m15:33:33.302490 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m15:33:33.302944 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    AVG(birth_year) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype
        );
[0m15:33:33.303345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:35.070132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.766 seconds
[0m15:33:35.075162 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m15:33:35.206330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00a92c73-173a-4451-822f-5d2df138f430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e776b0>]}
[0m15:33:35.208116 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.user_demographic_table ............. [[32mSUCCESS 1[0m in 1.92s]
[0m15:33:35.209090 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m15:33:35.211308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:35.211969 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m15:33:35.212498 [info ] [MainThread]: 
[0m15:33:35.212991 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.39 seconds (9.39s).
[0m15:33:35.214110 [debug] [MainThread]: Command end result
[0m15:33:35.247646 [info ] [MainThread]: 
[0m15:33:35.248162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:35.248428 [info ] [MainThread]: 
[0m15:33:35.248689 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:33:35.251816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.7029295, "process_user_time": 3.109802, "process_kernel_time": 0.696773, "process_mem_max_rss": "195887104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:33:35.252319 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:35.252235 after 10.70 seconds
[0m15:33:35.252657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203b5700>]}
[0m15:33:35.252943 [debug] [MainThread]: Flushing usage events
[0m18:15:53.534893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3bf80>]}


============================== 18:15:53.536779 | ec30d7a2-5a62-483f-a2d3-94e3265a0c9f ==============================
[0m18:15:53.536779 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:15:53.537122 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '/Users/parthmodi/.dbt', 'use_colors': 'True', 'debug': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m18:15:54.588265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec30d7a2-5a62-483f-a2d3-94e3265a0c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bfd6930>]}
[0m18:15:54.611318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec30d7a2-5a62-483f-a2d3-94e3265a0c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1295c1670>]}
[0m18:15:54.611917 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:15:54.624309 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:15:54.704423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:15:54.704769 [debug] [MainThread]: Partial parsing: updated file: elt://models/output/user_demographic_table.sql
[0m18:15:54.704960 [debug] [MainThread]: Partial parsing: updated file: elt://models/output/trip_summary_table.sql
[0m18:15:54.811521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec30d7a2-5a62-483f-a2d3-94e3265a0c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cd34f80>]}
[0m18:15:54.854181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec30d7a2-5a62-483f-a2d3-94e3265a0c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d07f4a0>]}
[0m18:15:54.854456 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m18:15:54.854630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec30d7a2-5a62-483f-a2d3-94e3265a0c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d0af8c0>]}
[0m18:15:54.855405 [info ] [MainThread]: 
[0m18:15:54.855712 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:15:54.857682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m18:15:54.863993 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m18:15:54.864172 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m18:15:54.864314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:55.522299 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.656 seconds
[0m18:15:55.528248 [debug] [ThreadPool]: On list_dev: Close
[0m18:15:55.662161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m18:15:55.675720 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m18:15:55.676177 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m18:15:55.676515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:56.312358 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.635 seconds
[0m18:15:56.318487 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m18:15:56.481025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec30d7a2-5a62-483f-a2d3-94e3265a0c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ce51b20>]}
[0m18:15:56.483027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:56.483929 [info ] [MainThread]: 
[0m18:15:56.487637 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m18:15:56.488267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m18:15:56.488734 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m18:15:56.499341 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m18:15:56.500659 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m18:15:56.501536 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m18:15:56.502207 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m18:15:56.502683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.trip_summary_table)
[0m18:15:56.503037 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m18:15:56.511041 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m18:15:56.511805 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m18:15:56.536819 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m18:15:56.538042 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m18:15:56.538312 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour
ORDER BY
    trip_hour
        );
[0m18:15:56.538555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:57.136232 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b84fe7-0004-26aa-0002-587f000113fa
[0m18:15:57.136960 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 16 at position 4
'__DBT__CTE__TRIP_DATA.LOAD_TIMESTAMP' in select clause is neither an aggregate nor in the group by clause.
[0m18:15:57.137658 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m18:15:57.303241 [debug] [Thread-1 (]: Database Error in model trip_summary_table (models/output/trip_summary_table.sql)
  001104 (42601): SQL compilation error: error line 16 at position 4
  '__DBT__CTE__TRIP_DATA.LOAD_TIMESTAMP' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/elt/models/output/trip_summary_table.sql
[0m18:15:57.305429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec30d7a2-5a62-483f-a2d3-94e3265a0c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108310950>]}
[0m18:15:57.306347 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model analytics.trip_summary_table ............. [[31mERROR[0m in 0.80s]
[0m18:15:57.307157 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m18:15:57.307721 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m18:15:57.308535 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.user_demographic_table .................. [RUN]
[0m18:15:57.309248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m18:15:57.309749 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m18:15:57.319554 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m18:15:57.320454 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m18:15:57.323129 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m18:15:57.324480 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m18:15:57.324877 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    AVG(birth_year) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype
        );
[0m18:15:57.325217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:58.624768 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b84fe7-0004-26af-0002-587f00016346
[0m18:15:58.626133 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 14 at position 4
'__DBT__CTE__TRIP_DATA.LOAD_TIMESTAMP' in select clause is neither an aggregate nor in the group by clause.
[0m18:15:58.627096 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m18:15:58.790455 [debug] [Thread-1 (]: Database Error in model user_demographic_table (models/output/user_demographic_table.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  '__DBT__CTE__TRIP_DATA.LOAD_TIMESTAMP' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/elt/models/output/user_demographic_table.sql
[0m18:15:58.792256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec30d7a2-5a62-483f-a2d3-94e3265a0c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d26e060>]}
[0m18:15:58.793876 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model analytics.user_demographic_table ......... [[31mERROR[0m in 1.48s]
[0m18:15:58.795114 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m18:15:58.796444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:58.796859 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m18:15:58.797280 [info ] [MainThread]: 
[0m18:15:58.797641 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m18:15:58.798512 [debug] [MainThread]: Command end result
[0m18:15:58.827489 [info ] [MainThread]: 
[0m18:15:58.827868 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:15:58.828091 [info ] [MainThread]: 
[0m18:15:58.828391 [error] [MainThread]:   Database Error in model trip_summary_table (models/output/trip_summary_table.sql)
  001104 (42601): SQL compilation error: error line 16 at position 4
  '__DBT__CTE__TRIP_DATA.LOAD_TIMESTAMP' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/elt/models/output/trip_summary_table.sql
[0m18:15:58.828621 [info ] [MainThread]: 
[0m18:15:58.828859 [error] [MainThread]:   Database Error in model user_demographic_table (models/output/user_demographic_table.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  '__DBT__CTE__TRIP_DATA.LOAD_TIMESTAMP' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/elt/models/output/user_demographic_table.sql
[0m18:15:58.829080 [info ] [MainThread]: 
[0m18:15:58.829306 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m18:15:58.832168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.3506517, "process_user_time": 3.144406, "process_kernel_time": 0.646312, "process_mem_max_rss": "197754880", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:15:58.832603 [debug] [MainThread]: Command `dbt run` failed at 18:15:58.832533 after 5.35 seconds
[0m18:15:58.832898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107880440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cb01940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3bf20>]}
[0m18:15:58.833138 [debug] [MainThread]: Flushing usage events
[0m18:19:24.352554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139681d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133cbec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111413a0>]}


============================== 18:19:24.354781 | f5a52682-7865-486d-965c-454190f4f713 ==============================
[0m18:19:24.354781 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:19:24.355138 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'quiet': 'False', 'empty': 'False', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'target_path': 'None', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'warn_error': 'None', 'no_print': 'None', 'profiles_dir': '/Users/parthmodi/.dbt'}
[0m18:19:25.163375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5a52682-7865-486d-965c-454190f4f713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274e8500>]}
[0m18:19:25.186496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5a52682-7865-486d-965c-454190f4f713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127996b70>]}
[0m18:19:25.187147 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:19:25.198520 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:19:25.276805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:19:25.277148 [debug] [MainThread]: Partial parsing: updated file: elt://models/output/user_demographic_table.sql
[0m18:19:25.277329 [debug] [MainThread]: Partial parsing: updated file: elt://models/output/trip_summary_table.sql
[0m18:19:25.383973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5a52682-7865-486d-965c-454190f4f713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c2090a0>]}
[0m18:19:25.424992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5a52682-7865-486d-965c-454190f4f713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c58b320>]}
[0m18:19:25.425277 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m18:19:25.425446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a52682-7865-486d-965c-454190f4f713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125029c0>]}
[0m18:19:25.426243 [info ] [MainThread]: 
[0m18:19:25.426532 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:19:25.428501 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m18:19:25.434800 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m18:19:25.434974 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m18:19:25.435105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:26.283099 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.847 seconds
[0m18:19:26.288306 [debug] [ThreadPool]: On list_dev: Close
[0m18:19:26.457313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m18:19:26.472911 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m18:19:26.473536 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m18:19:26.473867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:27.050711 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.576 seconds
[0m18:19:27.055502 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m18:19:27.210248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a52682-7865-486d-965c-454190f4f713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c393950>]}
[0m18:19:27.211815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:19:27.212617 [info ] [MainThread]: 
[0m18:19:27.215693 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m18:19:27.216347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m18:19:27.216832 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m18:19:27.227377 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m18:19:27.228554 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m18:19:27.229387 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m18:19:27.229998 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m18:19:27.230516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.trip_summary_table)
[0m18:19:27.230902 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m18:19:27.238877 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m18:19:27.239544 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m18:19:27.265006 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m18:19:27.266177 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m18:19:27.266451 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour, load_timestamp
ORDER BY
    trip_hour
        );
[0m18:19:27.266687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:33.308504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.041 seconds
[0m18:19:33.340682 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m18:19:33.498938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a52682-7865-486d-965c-454190f4f713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124a4b90>]}
[0m18:19:33.500284 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 6.27s]
[0m18:19:33.501019 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m18:19:33.501478 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m18:19:33.502043 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.user_demographic_table .................. [RUN]
[0m18:19:33.502556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m18:19:33.502935 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m18:19:33.511238 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m18:19:33.512024 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m18:19:33.514127 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m18:19:33.515250 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m18:19:33.515563 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    AVG(birth_year) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype, load_timestamp
        );
[0m18:19:33.515852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:35.570732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.054 seconds
[0m18:19:35.577711 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m18:19:35.746456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a52682-7865-486d-965c-454190f4f713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d230ec0>]}
[0m18:19:35.748580 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.user_demographic_table ............. [[32mSUCCESS 1[0m in 2.24s]
[0m18:19:35.749925 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m18:19:35.751585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:35.752106 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m18:19:35.752616 [info ] [MainThread]: 
[0m18:19:35.753083 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.33 seconds (10.33s).
[0m18:19:35.754217 [debug] [MainThread]: Command end result
[0m18:19:35.788567 [info ] [MainThread]: 
[0m18:19:35.789089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:35.789353 [info ] [MainThread]: 
[0m18:19:35.789611 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:19:35.792305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.494083, "process_user_time": 3.097526, "process_kernel_time": 0.626675, "process_mem_max_rss": "197394432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:19:35.792758 [debug] [MainThread]: Command `dbt run` succeeded at 18:19:35.792684 after 11.49 seconds
[0m18:19:35.793058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113157bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c1dd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139c0200>]}
[0m18:19:35.793319 [debug] [MainThread]: Flushing usage events
[0m18:23:09.310303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d83aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb1fd0>]}


============================== 18:23:09.312314 | d011ab22-81b3-41a9-ac62-44f021173c95 ==============================
[0m18:23:09.312314 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:23:09.312639 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '/Users/parthmodi/.dbt', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'write_json': 'True', 'empty': 'False', 'static_parser': 'True', 'no_print': 'None', 'introspect': 'True', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m18:23:10.278067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd011ab22-81b3-41a9-ac62-44f021173c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1342d6f30>]}
[0m18:23:10.300966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd011ab22-81b3-41a9-ac62-44f021173c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130186090>]}
[0m18:23:10.301543 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:23:10.312218 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:23:10.391808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:23:10.392134 [debug] [MainThread]: Partial parsing: updated file: elt://models/output/user_demographic_table.sql
[0m18:23:10.497060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd011ab22-81b3-41a9-ac62-44f021173c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348b56a0>]}
[0m18:23:10.539561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd011ab22-81b3-41a9-ac62-44f021173c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134886ff0>]}
[0m18:23:10.539834 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m18:23:10.540001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd011ab22-81b3-41a9-ac62-44f021173c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134490140>]}
[0m18:23:10.540774 [info ] [MainThread]: 
[0m18:23:10.541061 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:23:10.543032 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m18:23:10.549329 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m18:23:10.549506 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m18:23:10.549644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:11.199273 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.649 seconds
[0m18:23:11.205904 [debug] [ThreadPool]: On list_dev: Close
[0m18:23:11.341248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m18:23:11.353029 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m18:23:11.353488 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m18:23:11.353834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:11.970983 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.617 seconds
[0m18:23:11.977786 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m18:23:12.107627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd011ab22-81b3-41a9-ac62-44f021173c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1337b6d20>]}
[0m18:23:12.109089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:12.109866 [info ] [MainThread]: 
[0m18:23:12.114264 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m18:23:12.114921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m18:23:12.115427 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m18:23:12.126118 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m18:23:12.127333 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m18:23:12.128119 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m18:23:12.128728 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m18:23:12.129345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.trip_summary_table)
[0m18:23:12.129821 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m18:23:12.137946 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m18:23:12.138649 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m18:23:12.162937 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m18:23:12.164258 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m18:23:12.164555 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour, load_timestamp
ORDER BY
    trip_hour
        );
[0m18:23:12.164797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:17.381475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.216 seconds
[0m18:23:17.415381 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m18:23:17.572263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd011ab22-81b3-41a9-ac62-44f021173c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1342d6180>]}
[0m18:23:17.573196 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 5.44s]
[0m18:23:17.573912 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m18:23:17.574389 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m18:23:17.575051 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.user_demographic_table .................. [RUN]
[0m18:23:17.575674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m18:23:17.576106 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m18:23:17.584562 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m18:23:17.586419 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m18:23:17.588571 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m18:23:17.589796 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m18:23:17.590128 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    ROUND(AVG(birth_year)) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype, load_timestamp
        );
[0m18:23:17.590418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:19.502685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.912 seconds
[0m18:23:19.510384 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m18:23:19.647355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd011ab22-81b3-41a9-ac62-44f021173c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137025a60>]}
[0m18:23:19.649527 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.user_demographic_table ............. [[32mSUCCESS 1[0m in 2.07s]
[0m18:23:19.650877 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m18:23:19.652495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:19.652980 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m18:23:19.653482 [info ] [MainThread]: 
[0m18:23:19.653932 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.11 seconds (9.11s).
[0m18:23:19.654977 [debug] [MainThread]: Command end result
[0m18:23:19.688323 [info ] [MainThread]: 
[0m18:23:19.688727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:19.688982 [info ] [MainThread]: 
[0m18:23:19.689240 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:23:19.692345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.435614, "process_user_time": 2.513686, "process_kernel_time": 1.414582, "process_mem_max_rss": "196968448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:23:19.692782 [debug] [MainThread]: Command `dbt run` succeeded at 18:23:19.692706 after 10.44 seconds
[0m18:23:19.693084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079576e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902bce0>]}
[0m18:23:19.693365 [debug] [MainThread]: Flushing usage events
[0m18:28:08.467631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107381040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107035d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106323da0>]}


============================== 18:28:08.469820 | 0fbf0b4d-ed7c-4c7a-a695-2afe5739b4f3 ==============================
[0m18:28:08.469820 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:28:08.470137 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'empty': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/parthmodi/.dbt', 'debug': 'False', 'log_format': 'default', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs'}
[0m18:28:09.420558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fbf0b4d-ed7c-4c7a-a695-2afe5739b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12592af30>]}
[0m18:28:09.443485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fbf0b4d-ed7c-4c7a-a695-2afe5739b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f6060>]}
[0m18:28:09.444120 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:28:09.456000 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:28:09.535775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:28:09.536088 [debug] [MainThread]: Partial parsing: added file: elt://models/output/station_summary.sql
[0m18:28:09.536303 [debug] [MainThread]: Partial parsing: updated file: elt://models/source.yml
[0m18:28:09.678097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fbf0b4d-ed7c-4c7a-a695-2afe5739b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c973e0>]}
[0m18:28:09.721366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fbf0b4d-ed7c-4c7a-a695-2afe5739b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e7f620>]}
[0m18:28:09.721638 [info ] [MainThread]: Found 4 models, 4 sources, 459 macros
[0m18:28:09.721810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fbf0b4d-ed7c-4c7a-a695-2afe5739b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc7a70>]}
[0m18:28:09.722628 [info ] [MainThread]: 
[0m18:28:09.722930 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:28:09.725028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m18:28:09.731427 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m18:28:09.731610 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m18:28:09.731747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:10.400769 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.668 seconds
[0m18:28:10.407167 [debug] [ThreadPool]: On list_dev: Close
[0m18:28:10.548704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m18:28:10.563555 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m18:28:10.564048 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m18:28:10.564391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:11.376359 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.812 seconds
[0m18:28:11.380695 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m18:28:11.524607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fbf0b4d-ed7c-4c7a-a695-2afe5739b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d54560>]}
[0m18:28:11.526352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:11.527099 [info ] [MainThread]: 
[0m18:28:11.531068 [debug] [Thread-1 (]: Began running node model.elt.station_summary
[0m18:28:11.531861 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.station_summary ......................... [RUN]
[0m18:28:11.532490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.station_summary)
[0m18:28:11.532947 [debug] [Thread-1 (]: Began compiling node model.elt.station_summary
[0m18:28:11.543229 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.station_summary"
[0m18:28:11.544073 [debug] [Thread-1 (]: Began executing node model.elt.station_summary
[0m18:28:11.571794 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.station_summary"
[0m18:28:11.572991 [debug] [Thread-1 (]: Using snowflake connection "model.elt.station_summary"
[0m18:28:11.573315 [debug] [Thread-1 (]: On model.elt.station_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.station_summary"} */
create or replace transient table dev.analytics.station_summary
         as
        (SELECT
    start_station_id,
    start_station_name,
    COUNT(*) AS total_trips_started,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    load_timestamp
FROM 
    dev.raw_data.trip_data
GROUP BY 
    start_station_id, start_station_name, load_timestamp
        );
[0m18:28:11.573583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:13.889890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.316 seconds
[0m18:28:13.925235 [debug] [Thread-1 (]: On model.elt.station_summary: Close
[0m18:28:14.089500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbf0b4d-ed7c-4c7a-a695-2afe5739b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ad9fd0>]}
[0m18:28:14.091221 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.station_summary .................... [[32mSUCCESS 1[0m in 2.55s]
[0m18:28:14.092191 [debug] [Thread-1 (]: Finished running node model.elt.station_summary
[0m18:28:14.092925 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m18:28:14.094166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.station_summary, now model.elt.trip_data)
[0m18:28:14.094908 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m18:28:14.099022 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m18:28:14.100472 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m18:28:14.101545 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m18:28:14.102161 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m18:28:14.102707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.trip_summary_table)
[0m18:28:14.103145 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m18:28:14.112084 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m18:28:14.112827 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m18:28:14.116288 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m18:28:14.117786 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m18:28:14.118154 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour, load_timestamp
ORDER BY
    trip_hour
        );
[0m18:28:14.118510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:19.627086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.508 seconds
[0m18:28:19.641470 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m18:28:19.812576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbf0b4d-ed7c-4c7a-a695-2afe5739b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f5eb10>]}
[0m18:28:19.814330 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 5.71s]
[0m18:28:19.815276 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m18:28:19.815983 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m18:28:19.817055 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.user_demographic_table .................. [RUN]
[0m18:28:19.818052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m18:28:19.818650 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m18:28:19.829359 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m18:28:19.831546 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m18:28:19.834506 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m18:28:19.836310 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m18:28:19.836777 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    ROUND(AVG(birth_year)) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype, load_timestamp
        );
[0m18:28:19.837167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:21.570955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.733 seconds
[0m18:28:21.578389 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m18:28:21.734362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbf0b4d-ed7c-4c7a-a695-2afe5739b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f41ca0>]}
[0m18:28:21.736791 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.user_demographic_table ............. [[32mSUCCESS 1[0m in 1.92s]
[0m18:28:21.738047 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m18:28:21.739621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:21.740038 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m18:28:21.740505 [info ] [MainThread]: 
[0m18:28:21.740921 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 12.02 seconds (12.02s).
[0m18:28:21.742121 [debug] [MainThread]: Command end result
[0m18:28:21.776139 [info ] [MainThread]: 
[0m18:28:21.776579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:28:21.776821 [info ] [MainThread]: 
[0m18:28:21.777071 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:28:21.780068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.371018, "process_user_time": 3.317046, "process_kernel_time": 0.568373, "process_mem_max_rss": "198098944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:28:21.780452 [debug] [MainThread]: Command `dbt run` succeeded at 18:28:21.780388 after 13.37 seconds
[0m18:28:21.780736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126cb3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d4230>]}
[0m18:28:21.780984 [debug] [MainThread]: Flushing usage events
[0m22:44:16.881570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104334080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053dffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104367cb0>]}


============================== 22:44:16.883586 | a403ccd7-8845-43e5-b2a4-c045f9453a42 ==============================
[0m22:44:16.883586 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:44:16.883925 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '/Users/parthmodi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'invocation_command': 'dbt run', 'quiet': 'False'}
[0m22:44:17.851400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a403ccd7-8845-43e5-b2a4-c045f9453a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f836930>]}
[0m22:44:17.874405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a403ccd7-8845-43e5-b2a4-c045f9453a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104173fb0>]}
[0m22:44:17.875030 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:44:17.887176 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:44:17.967517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m22:44:17.967842 [debug] [MainThread]: Partial parsing: added file: elt://models/output/trip_duration_table.sql
[0m22:44:17.968063 [debug] [MainThread]: Partial parsing: updated file: elt://models/source.yml
[0m22:44:17.968233 [debug] [MainThread]: Partial parsing: updated file: elt://models/output/station_summary.sql
[0m22:44:18.112649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a403ccd7-8845-43e5-b2a4-c045f9453a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a79b8c0>]}
[0m22:44:18.155727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a403ccd7-8845-43e5-b2a4-c045f9453a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a240a40>]}
[0m22:44:18.156008 [info ] [MainThread]: Found 5 models, 5 sources, 459 macros
[0m22:44:18.156177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a403ccd7-8845-43e5-b2a4-c045f9453a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a0cbfe0>]}
[0m22:44:18.157004 [info ] [MainThread]: 
[0m22:44:18.157299 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:44:18.159378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:44:18.165771 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:44:18.165949 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:44:18.166080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:18.797344 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.630 seconds
[0m22:44:18.803152 [debug] [ThreadPool]: On list_dev: Close
[0m22:44:18.951102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:44:18.966245 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:44:18.966795 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:44:18.967152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:44:19.494245 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.527 seconds
[0m22:44:19.499671 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:44:19.629040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a403ccd7-8845-43e5-b2a4-c045f9453a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a387dd0>]}
[0m22:44:19.630419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:44:19.631061 [info ] [MainThread]: 
[0m22:44:19.635414 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m22:44:19.636124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m22:44:19.636605 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m22:44:19.648137 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m22:44:19.649328 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m22:44:19.650235 [debug] [Thread-1 (]: Began running node model.elt.station_summary
[0m22:44:19.650753 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.station_summary ......................... [RUN]
[0m22:44:19.651190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.station_summary)
[0m22:44:19.651545 [debug] [Thread-1 (]: Began compiling node model.elt.station_summary
[0m22:44:19.657244 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.station_summary"
[0m22:44:19.658196 [debug] [Thread-1 (]: Began executing node model.elt.station_summary
[0m22:44:19.683784 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.station_summary"
[0m22:44:19.684906 [debug] [Thread-1 (]: Using snowflake connection "model.elt.station_summary"
[0m22:44:19.685211 [debug] [Thread-1 (]: On model.elt.station_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.station_summary"} */
create or replace transient table dev.analytics.station_summary
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    start_station_id,
    start_station_name,
    COUNT(*) AS total_trips_started,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    start_station_id, start_station_name, load_timestamp
        );
[0m22:44:19.685472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:22.493690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.808 seconds
[0m22:44:22.527943 [debug] [Thread-1 (]: On model.elt.station_summary: Close
[0m22:44:22.642353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a403ccd7-8845-43e5-b2a4-c045f9453a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c8c80>]}
[0m22:44:22.643358 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.station_summary .................... [[32mSUCCESS 1[0m in 2.99s]
[0m22:44:22.644212 [debug] [Thread-1 (]: Finished running node model.elt.station_summary
[0m22:44:22.644789 [debug] [Thread-1 (]: Began running node model.elt.trip_duration_table
[0m22:44:22.645554 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.trip_duration_table ..................... [RUN]
[0m22:44:22.646247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.station_summary, now model.elt.trip_duration_table)
[0m22:44:22.646756 [debug] [Thread-1 (]: Began compiling node model.elt.trip_duration_table
[0m22:44:22.655577 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_duration_table"
[0m22:44:22.656593 [debug] [Thread-1 (]: Began executing node model.elt.trip_duration_table
[0m22:44:22.659350 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_duration_table"
[0m22:44:22.661086 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_duration_table"
[0m22:44:22.661521 [debug] [Thread-1 (]: On model.elt.trip_duration_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_duration_table"} */
create or replace transient table dev.analytics.trip_duration_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN tripduration < 300 THEN '0-5 mins'
        WHEN tripduration BETWEEN 300 AND 600 THEN '5-10 mins'
        WHEN tripduration BETWEEN 600 AND 1200 THEN '10-20 mins'
        WHEN tripduration BETWEEN 1200 AND 1800 THEN '20-30 mins'
        ELSE '30+ mins'
    END AS duration_range,
    COUNT(*) AS trip_count,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    duration_range, load_timestamp
ORDER BY 2 DESC
        );
[0m22:44:22.661880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:24.747437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.085 seconds
[0m22:44:24.754850 [debug] [Thread-1 (]: On model.elt.trip_duration_table: Close
[0m22:44:24.902939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a403ccd7-8845-43e5-b2a4-c045f9453a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a927d70>]}
[0m22:44:24.905466 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.trip_duration_table ................ [[32mSUCCESS 1[0m in 2.26s]
[0m22:44:24.906751 [debug] [Thread-1 (]: Finished running node model.elt.trip_duration_table
[0m22:44:24.907215 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m22:44:24.907765 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m22:44:24.908227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_duration_table, now model.elt.trip_summary_table)
[0m22:44:24.908517 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m22:44:24.915316 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m22:44:24.916061 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m22:44:24.918120 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m22:44:24.919258 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m22:44:24.919583 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour, load_timestamp
ORDER BY
    trip_hour
        );
[0m22:44:24.919865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:30.458559 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.538 seconds
[0m22:44:30.466019 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m22:44:30.610370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a403ccd7-8845-43e5-b2a4-c045f9453a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ac2fc80>]}
[0m22:44:30.612094 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 5.70s]
[0m22:44:30.613080 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m22:44:30.613777 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m22:44:30.614727 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.user_demographic_table .................. [RUN]
[0m22:44:30.615732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m22:44:30.616379 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m22:44:30.627729 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m22:44:30.629991 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m22:44:30.632772 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m22:44:30.634700 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m22:44:30.635253 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    ROUND(AVG(birth_year)) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype, load_timestamp
        );
[0m22:44:30.635709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:32.630204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.994 seconds
[0m22:44:32.635702 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m22:44:32.769965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a403ccd7-8845-43e5-b2a4-c045f9453a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a9246e0>]}
[0m22:44:32.772389 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.user_demographic_table ............. [[32mSUCCESS 1[0m in 2.15s]
[0m22:44:32.773759 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m22:44:32.775076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:44:32.775420 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m22:44:32.775833 [info ] [MainThread]: 
[0m22:44:32.776200 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 14.62 seconds (14.62s).
[0m22:44:32.777331 [debug] [MainThread]: Command end result
[0m22:44:32.804388 [info ] [MainThread]: 
[0m22:44:32.804736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:44:32.804964 [info ] [MainThread]: 
[0m22:44:32.805204 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:44:32.808108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.984459, "process_user_time": 3.327278, "process_kernel_time": 0.640253, "process_mem_max_rss": "197967872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:44:32.808542 [debug] [MainThread]: Command `dbt run` succeeded at 22:44:32.808468 after 15.98 seconds
[0m22:44:32.808806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a544320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a384860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105418260>]}
[0m22:44:32.809042 [debug] [MainThread]: Flushing usage events
[0m22:48:18.331263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10856e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108873fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108873ce0>]}


============================== 22:48:18.333367 | 857f9e36-eb14-4480-b822-b49a750bd23c ==============================
[0m22:48:18.333367 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:48:18.333728 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/parthmodi/.dbt', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'partial_parse': 'True'}
[0m22:48:19.293914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108848f80>]}
[0m22:48:19.316963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109474110>]}
[0m22:48:19.317604 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:48:19.329867 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:48:19.411623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:48:19.411932 [debug] [MainThread]: Partial parsing: added file: elt://models/output/seasonal_trip_analysis.sql
[0m22:48:19.412154 [debug] [MainThread]: Partial parsing: updated file: elt://models/source.yml
[0m22:48:19.556499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12229fc50>]}
[0m22:48:19.598861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122185670>]}
[0m22:48:19.599145 [info ] [MainThread]: Found 6 models, 6 sources, 459 macros
[0m22:48:19.599319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122676ed0>]}
[0m22:48:19.600181 [info ] [MainThread]: 
[0m22:48:19.600477 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:48:19.602588 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:48:19.608967 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:48:19.609145 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:48:19.609283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:20.243114 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.633 seconds
[0m22:48:20.247994 [debug] [ThreadPool]: On list_dev: Close
[0m22:48:20.385541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:48:20.399400 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:48:20.399838 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:48:20.400178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:20.904078 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.504 seconds
[0m22:48:20.908909 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:48:21.042424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12229e870>]}
[0m22:48:21.043607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:48:21.044171 [info ] [MainThread]: 
[0m22:48:21.048084 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m22:48:21.048648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m22:48:21.049091 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m22:48:21.060566 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m22:48:21.061802 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m22:48:21.062733 [debug] [Thread-1 (]: Began running node model.elt.seasonal_trip_analysis
[0m22:48:21.063382 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.seasonal_trip_analysis .................. [RUN]
[0m22:48:21.063855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.seasonal_trip_analysis)
[0m22:48:21.064212 [debug] [Thread-1 (]: Began compiling node model.elt.seasonal_trip_analysis
[0m22:48:21.072621 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.seasonal_trip_analysis"
[0m22:48:21.073383 [debug] [Thread-1 (]: Began executing node model.elt.seasonal_trip_analysis
[0m22:48:21.098020 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.seasonal_trip_analysis"
[0m22:48:21.099443 [debug] [Thread-1 (]: Using snowflake connection "model.elt.seasonal_trip_analysis"
[0m22:48:21.099744 [debug] [Thread-1 (]: On model.elt.seasonal_trip_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.seasonal_trip_analysis"} */
create or replace transient table dev.analytics.seasonal_trip_analysis
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN EXTRACT(MONTH, starttime) IN (12, 1, 2) THEN 'Winter (Dec-Feb)'
        WHEN EXTRACT(MONTH, starttime) IN (3, 4, 5) THEN 'Spring (Mar-May)'
        WHEN EXTRACT(MONTH, starttime) IN (6, 7, 8) THEN 'Summer (Jun-Aug)'
        WHEN EXTRACT(MONTH, starttime) IN (9, 10, 11) THEN 'Fall (Sept-Nov)'
    END AS season,
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    season, load_timestamp
        );
[0m22:48:21.099993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:23.446931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.346 seconds
[0m22:48:23.476845 [debug] [Thread-1 (]: On model.elt.seasonal_trip_analysis: Close
[0m22:48:23.615767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215d6090>]}
[0m22:48:23.617220 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.seasonal_trip_analysis ............. [[32mSUCCESS 1[0m in 2.55s]
[0m22:48:23.617843 [debug] [Thread-1 (]: Finished running node model.elt.seasonal_trip_analysis
[0m22:48:23.618261 [debug] [Thread-1 (]: Began running node model.elt.station_summary
[0m22:48:23.618694 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.station_summary ......................... [RUN]
[0m22:48:23.619240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.seasonal_trip_analysis, now model.elt.station_summary)
[0m22:48:23.619720 [debug] [Thread-1 (]: Began compiling node model.elt.station_summary
[0m22:48:23.625084 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.station_summary"
[0m22:48:23.625849 [debug] [Thread-1 (]: Began executing node model.elt.station_summary
[0m22:48:23.628046 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.station_summary"
[0m22:48:23.629177 [debug] [Thread-1 (]: Using snowflake connection "model.elt.station_summary"
[0m22:48:23.629516 [debug] [Thread-1 (]: On model.elt.station_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.station_summary"} */
create or replace transient table dev.analytics.station_summary
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    start_station_id,
    start_station_name,
    COUNT(*) AS total_trips_started,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    start_station_id, start_station_name, load_timestamp
        );
[0m22:48:23.629805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:25.595073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.965 seconds
[0m22:48:25.604984 [debug] [Thread-1 (]: On model.elt.station_summary: Close
[0m22:48:25.740076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12285c440>]}
[0m22:48:25.741735 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.station_summary .................... [[32mSUCCESS 1[0m in 2.12s]
[0m22:48:25.742734 [debug] [Thread-1 (]: Finished running node model.elt.station_summary
[0m22:48:25.743455 [debug] [Thread-1 (]: Began running node model.elt.trip_duration_table
[0m22:48:25.744437 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.trip_duration_table ..................... [RUN]
[0m22:48:25.745392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.station_summary, now model.elt.trip_duration_table)
[0m22:48:25.745966 [debug] [Thread-1 (]: Began compiling node model.elt.trip_duration_table
[0m22:48:25.755604 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_duration_table"
[0m22:48:25.756445 [debug] [Thread-1 (]: Began executing node model.elt.trip_duration_table
[0m22:48:25.759225 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_duration_table"
[0m22:48:25.760829 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_duration_table"
[0m22:48:25.761269 [debug] [Thread-1 (]: On model.elt.trip_duration_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_duration_table"} */
create or replace transient table dev.analytics.trip_duration_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN tripduration < 300 THEN '0-5 mins'
        WHEN tripduration BETWEEN 300 AND 600 THEN '5-10 mins'
        WHEN tripduration BETWEEN 600 AND 1200 THEN '10-20 mins'
        WHEN tripduration BETWEEN 1200 AND 1800 THEN '20-30 mins'
        ELSE '30+ mins'
    END AS duration_range,
    COUNT(*) AS trip_count,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    duration_range, load_timestamp
ORDER BY 2 DESC
        );
[0m22:48:25.761658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:27.951454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.189 seconds
[0m22:48:27.957500 [debug] [Thread-1 (]: On model.elt.trip_duration_table: Close
[0m22:48:28.088088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c40aa0>]}
[0m22:48:28.090002 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.trip_duration_table ................ [[32mSUCCESS 1[0m in 2.34s]
[0m22:48:28.091333 [debug] [Thread-1 (]: Finished running node model.elt.trip_duration_table
[0m22:48:28.092133 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m22:48:28.093110 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m22:48:28.093969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_duration_table, now model.elt.trip_summary_table)
[0m22:48:28.094501 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m22:48:28.105017 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m22:48:28.105876 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m22:48:28.108571 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m22:48:28.110277 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m22:48:28.110740 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour, load_timestamp
ORDER BY
    trip_hour
        );
[0m22:48:28.111130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:33.790290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.679 seconds
[0m22:48:33.798437 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m22:48:33.948137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c3d430>]}
[0m22:48:33.949573 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 5.85s]
[0m22:48:33.950417 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m22:48:33.951024 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m22:48:33.951740 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.user_demographic_table .................. [RUN]
[0m22:48:33.952449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m22:48:33.953209 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m22:48:33.963559 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m22:48:33.965432 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m22:48:33.968384 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m22:48:33.970084 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m22:48:33.970565 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    ROUND(AVG(birth_year)) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype, load_timestamp
        );
[0m22:48:33.970978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:35.809671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.838 seconds
[0m22:48:35.818187 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m22:48:35.961490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857f9e36-eb14-4480-b822-b49a750bd23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122820320>]}
[0m22:48:35.964107 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.user_demographic_table ............. [[32mSUCCESS 1[0m in 2.01s]
[0m22:48:35.964930 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m22:48:35.966076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:35.966396 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m22:48:35.966749 [info ] [MainThread]: 
[0m22:48:35.967049 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 16.37 seconds (16.37s).
[0m22:48:35.968159 [debug] [MainThread]: Command end result
[0m22:48:36.038621 [info ] [MainThread]: 
[0m22:48:36.038888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:48:36.039042 [info ] [MainThread]: 
[0m22:48:36.039197 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:48:36.041394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.76772, "process_user_time": 3.405699, "process_kernel_time": 0.664405, "process_mem_max_rss": "198311936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:48:36.041665 [debug] [MainThread]: Command `dbt run` succeeded at 22:48:36.041620 after 17.77 seconds
[0m22:48:36.041842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c5bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c595e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c59550>]}
[0m22:48:36.042000 [debug] [MainThread]: Flushing usage events
[0m22:56:22.932446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5faa0>]}


============================== 22:56:22.934655 | 64d2b8d7-61f7-4c06-8a10-7524ec243315 ==============================
[0m22:56:22.934655 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:56:22.934980 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/parthmodi/.dbt', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'use_colors': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True'}
[0m22:56:23.907049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c9ab2c0>]}
[0m22:56:23.930495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0aa8d0>]}
[0m22:56:23.931157 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:56:23.943611 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:56:24.026426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:56:24.026739 [debug] [MainThread]: Partial parsing: added file: elt://models/output/trip_by_days_of_week.sql
[0m22:56:24.026964 [debug] [MainThread]: Partial parsing: updated file: elt://models/source.yml
[0m22:56:24.172786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ca82f30>]}
[0m22:56:24.217160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d279eb0>]}
[0m22:56:24.217466 [info ] [MainThread]: Found 7 models, 7 sources, 459 macros
[0m22:56:24.217642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c177a0>]}
[0m22:56:24.218514 [info ] [MainThread]: 
[0m22:56:24.218817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:56:24.220967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:56:24.227465 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:56:24.227638 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:56:24.227780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:24.818935 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.591 seconds
[0m22:56:24.825413 [debug] [ThreadPool]: On list_dev: Close
[0m22:56:24.958397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:56:24.971038 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:56:24.971506 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:56:24.971863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:56:25.501161 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.529 seconds
[0m22:56:25.507327 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:56:25.647760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cb710a0>]}
[0m22:56:25.648978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:56:25.649628 [info ] [MainThread]: 
[0m22:56:25.654028 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m22:56:25.654652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m22:56:25.655124 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m22:56:25.666438 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m22:56:25.667710 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m22:56:25.668622 [debug] [Thread-1 (]: Began running node model.elt.seasonal_trip_analysis
[0m22:56:25.669250 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics.seasonal_trip_analysis .................. [RUN]
[0m22:56:25.669715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.seasonal_trip_analysis)
[0m22:56:25.670068 [debug] [Thread-1 (]: Began compiling node model.elt.seasonal_trip_analysis
[0m22:56:25.678519 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.seasonal_trip_analysis"
[0m22:56:25.679595 [debug] [Thread-1 (]: Began executing node model.elt.seasonal_trip_analysis
[0m22:56:25.703445 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.seasonal_trip_analysis"
[0m22:56:25.704770 [debug] [Thread-1 (]: Using snowflake connection "model.elt.seasonal_trip_analysis"
[0m22:56:25.705046 [debug] [Thread-1 (]: On model.elt.seasonal_trip_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.seasonal_trip_analysis"} */
create or replace transient table dev.analytics.seasonal_trip_analysis
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN EXTRACT(MONTH, starttime) IN (12, 1, 2) THEN 'Winter (Dec-Feb)'
        WHEN EXTRACT(MONTH, starttime) IN (3, 4, 5) THEN 'Spring (Mar-May)'
        WHEN EXTRACT(MONTH, starttime) IN (6, 7, 8) THEN 'Summer (Jun-Aug)'
        WHEN EXTRACT(MONTH, starttime) IN (9, 10, 11) THEN 'Fall (Sept-Nov)'
    END AS season,
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    season, load_timestamp
        );
[0m22:56:25.705282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:28.221667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.516 seconds
[0m22:56:28.256121 [debug] [Thread-1 (]: On model.elt.seasonal_trip_analysis: Close
[0m22:56:28.383418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c9dddc0>]}
[0m22:56:28.385047 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics.seasonal_trip_analysis ............. [[32mSUCCESS 1[0m in 2.71s]
[0m22:56:28.385766 [debug] [Thread-1 (]: Finished running node model.elt.seasonal_trip_analysis
[0m22:56:28.386204 [debug] [Thread-1 (]: Began running node model.elt.station_summary
[0m22:56:28.386714 [info ] [Thread-1 (]: 2 of 6 START sql table model analytics.station_summary ......................... [RUN]
[0m22:56:28.387182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.seasonal_trip_analysis, now model.elt.station_summary)
[0m22:56:28.387503 [debug] [Thread-1 (]: Began compiling node model.elt.station_summary
[0m22:56:28.392562 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.station_summary"
[0m22:56:28.394269 [debug] [Thread-1 (]: Began executing node model.elt.station_summary
[0m22:56:28.396343 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.station_summary"
[0m22:56:28.397325 [debug] [Thread-1 (]: Using snowflake connection "model.elt.station_summary"
[0m22:56:28.397598 [debug] [Thread-1 (]: On model.elt.station_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.station_summary"} */
create or replace transient table dev.analytics.station_summary
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    start_station_id,
    start_station_name,
    COUNT(*) AS total_trips_started,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    start_station_id, start_station_name, load_timestamp
        );
[0m22:56:28.397874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:30.370259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.972 seconds
[0m22:56:30.377220 [debug] [Thread-1 (]: On model.elt.station_summary: Close
[0m22:56:30.526398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d668830>]}
[0m22:56:30.527610 [info ] [Thread-1 (]: 2 of 6 OK created sql table model analytics.station_summary .................... [[32mSUCCESS 1[0m in 2.14s]
[0m22:56:30.528451 [debug] [Thread-1 (]: Finished running node model.elt.station_summary
[0m22:56:30.529022 [debug] [Thread-1 (]: Began running node model.elt.trip_by_days_of_week
[0m22:56:30.529752 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.trip_by_days_of_week .................... [RUN]
[0m22:56:30.530424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.station_summary, now model.elt.trip_by_days_of_week)
[0m22:56:30.530921 [debug] [Thread-1 (]: Began compiling node model.elt.trip_by_days_of_week
[0m22:56:30.537801 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_by_days_of_week"
[0m22:56:30.538939 [debug] [Thread-1 (]: Began executing node model.elt.trip_by_days_of_week
[0m22:56:30.541810 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_by_days_of_week"
[0m22:56:30.543455 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_by_days_of_week"
[0m22:56:30.543881 [debug] [Thread-1 (]: On model.elt.trip_by_days_of_week: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_by_days_of_week"} */
create or replace transient table dev.analytics.trip_by_days_of_week
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    EXTRACT(DAYOFWEEK, starttime) AS day_of_week,
    COUNT(*) AS total_trips,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    day_of_week, load_timestamp
ORDER BY 
    day_of_week
        );
[0m22:56:30.544287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:32.909588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.365 seconds
[0m22:56:32.915011 [debug] [Thread-1 (]: On model.elt.trip_by_days_of_week: Close
[0m22:56:33.070342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d84e210>]}
[0m22:56:33.072851 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.trip_by_days_of_week ............... [[32mSUCCESS 1[0m in 2.54s]
[0m22:56:33.074182 [debug] [Thread-1 (]: Finished running node model.elt.trip_by_days_of_week
[0m22:56:33.074697 [debug] [Thread-1 (]: Began running node model.elt.trip_duration_table
[0m22:56:33.075351 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.trip_duration_table ..................... [RUN]
[0m22:56:33.075956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_by_days_of_week, now model.elt.trip_duration_table)
[0m22:56:33.076367 [debug] [Thread-1 (]: Began compiling node model.elt.trip_duration_table
[0m22:56:33.084217 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_duration_table"
[0m22:56:33.085974 [debug] [Thread-1 (]: Began executing node model.elt.trip_duration_table
[0m22:56:33.088376 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_duration_table"
[0m22:56:33.089726 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_duration_table"
[0m22:56:33.090090 [debug] [Thread-1 (]: On model.elt.trip_duration_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_duration_table"} */
create or replace transient table dev.analytics.trip_duration_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN tripduration < 300 THEN '0-5 mins'
        WHEN tripduration BETWEEN 300 AND 600 THEN '5-10 mins'
        WHEN tripduration BETWEEN 600 AND 1200 THEN '10-20 mins'
        WHEN tripduration BETWEEN 1200 AND 1800 THEN '20-30 mins'
        ELSE '30+ mins'
    END AS duration_range,
    COUNT(*) AS trip_count,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    duration_range, load_timestamp
ORDER BY 2 DESC
        );
[0m22:56:33.090427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:35.079154 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.988 seconds
[0m22:56:35.089156 [debug] [Thread-1 (]: On model.elt.trip_duration_table: Close
[0m22:56:35.242239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d60f080>]}
[0m22:56:35.243904 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.trip_duration_table ................ [[32mSUCCESS 1[0m in 2.17s]
[0m22:56:35.245577 [debug] [Thread-1 (]: Finished running node model.elt.trip_duration_table
[0m22:56:35.246422 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m22:56:35.247201 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m22:56:35.247952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_duration_table, now model.elt.trip_summary_table)
[0m22:56:35.248458 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m22:56:35.259003 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m22:56:35.260001 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m22:56:35.262748 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m22:56:35.264495 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m22:56:35.264938 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour, load_timestamp
ORDER BY
    trip_hour
        );
[0m22:56:35.265349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:40.611316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.346 seconds
[0m22:56:40.617168 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m22:56:40.750027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d60f980>]}
[0m22:56:40.752214 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 5.50s]
[0m22:56:40.753569 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m22:56:40.754265 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m22:56:40.755045 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.user_demographic_table .................. [RUN]
[0m22:56:40.755917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m22:56:40.756572 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m22:56:40.767915 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m22:56:40.769915 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m22:56:40.772683 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m22:56:40.774255 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m22:56:40.774715 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    ROUND(AVG(birth_year)) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype, load_timestamp
        );
[0m22:56:40.775128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:42.382702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.607 seconds
[0m22:56:42.389136 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m22:56:42.565454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d2b8d7-61f7-4c06-8a10-7524ec243315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d85cf20>]}
[0m22:56:42.566868 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.user_demographic_table ............. [[32mSUCCESS 1[0m in 1.81s]
[0m22:56:42.567955 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m22:56:42.569619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:42.570059 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m22:56:42.570538 [info ] [MainThread]: 
[0m22:56:42.571004 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.35 seconds (18.35s).
[0m22:56:42.572730 [debug] [MainThread]: Command end result
[0m22:56:42.649862 [info ] [MainThread]: 
[0m22:56:42.650147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:56:42.650315 [info ] [MainThread]: 
[0m22:56:42.650487 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:56:42.652770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.77243, "process_user_time": 3.450809, "process_kernel_time": 0.532033, "process_mem_max_rss": "198361088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:56:42.653010 [debug] [MainThread]: Command `dbt run` succeeded at 22:56:42.652967 after 19.77 seconds
[0m22:56:42.653187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a26d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a82d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d866270>]}
[0m22:56:42.653359 [debug] [MainThread]: Flushing usage events
[0m23:02:58.345728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048aedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039487d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10394baa0>]}


============================== 23:02:58.347793 | 1898d200-8c55-481f-bc04-65051a781e3f ==============================
[0m23:02:58.347793 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:02:58.348120 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'quiet': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'indirect_selection': 'eager', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'profiles_dir': '/Users/parthmodi/.dbt', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'write_json': 'True', 'log_cache_events': 'False'}
[0m23:02:59.293806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106067f80>]}
[0m23:02:59.316851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136440170>]}
[0m23:02:59.317489 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:02:59.330273 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:02:59.413187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:02:59.413509 [debug] [MainThread]: Partial parsing: added file: elt://models/output/bike_summary_table.sql
[0m23:02:59.413741 [debug] [MainThread]: Partial parsing: updated file: elt://models/source.yml
[0m23:02:59.557777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d20f50>]}
[0m23:02:59.601464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141b94590>]}
[0m23:02:59.601744 [info ] [MainThread]: Found 8 models, 8 sources, 459 macros
[0m23:02:59.601911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5ef60>]}
[0m23:02:59.602783 [info ] [MainThread]: 
[0m23:02:59.603075 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:02:59.605233 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:02:59.611566 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:02:59.611744 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:02:59.611884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:00.378426 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.765 seconds
[0m23:03:00.382710 [debug] [ThreadPool]: On list_dev: Close
[0m23:03:00.523808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m23:03:00.537406 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:03:00.537855 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:03:00.538179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:01.136766 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.598 seconds
[0m23:03:01.141292 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:03:01.283260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141af95b0>]}
[0m23:03:01.285126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:01.286067 [info ] [MainThread]: 
[0m23:03:01.290026 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m23:03:01.290665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.elt.trip_data)
[0m23:03:01.291129 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m23:03:01.302059 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m23:03:01.303302 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m23:03:01.304306 [debug] [Thread-1 (]: Began running node model.elt.bike_summary_table
[0m23:03:01.304947 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics.bike_summary_table ...................... [RUN]
[0m23:03:01.305456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.bike_summary_table)
[0m23:03:01.305829 [debug] [Thread-1 (]: Began compiling node model.elt.bike_summary_table
[0m23:03:01.311575 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.bike_summary_table"
[0m23:03:01.312295 [debug] [Thread-1 (]: Began executing node model.elt.bike_summary_table
[0m23:03:01.337844 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.bike_summary_table"
[0m23:03:01.338932 [debug] [Thread-1 (]: Using snowflake connection "model.elt.bike_summary_table"
[0m23:03:01.339212 [debug] [Thread-1 (]: On model.elt.bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.bike_summary_table"} */
create or replace transient table dev.analytics.bike_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    bikeid,
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    bikeid, load_timestamp
ORDER BY 
    total_trips DESC
        );
[0m23:03:01.339438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:03.162210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.822 seconds
[0m23:03:03.193451 [debug] [Thread-1 (]: On model.elt.bike_summary_table: Close
[0m23:03:03.325424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136fddd00>]}
[0m23:03:03.326762 [info ] [Thread-1 (]: 1 of 7 OK created sql table model analytics.bike_summary_table ................. [[32mSUCCESS 1[0m in 2.02s]
[0m23:03:03.327607 [debug] [Thread-1 (]: Finished running node model.elt.bike_summary_table
[0m23:03:03.328187 [debug] [Thread-1 (]: Began running node model.elt.seasonal_trip_analysis
[0m23:03:03.328974 [info ] [Thread-1 (]: 2 of 7 START sql table model analytics.seasonal_trip_analysis .................. [RUN]
[0m23:03:03.329676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.bike_summary_table, now model.elt.seasonal_trip_analysis)
[0m23:03:03.330176 [debug] [Thread-1 (]: Began compiling node model.elt.seasonal_trip_analysis
[0m23:03:03.341389 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.seasonal_trip_analysis"
[0m23:03:03.343271 [debug] [Thread-1 (]: Began executing node model.elt.seasonal_trip_analysis
[0m23:03:03.346108 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.seasonal_trip_analysis"
[0m23:03:03.347629 [debug] [Thread-1 (]: Using snowflake connection "model.elt.seasonal_trip_analysis"
[0m23:03:03.348045 [debug] [Thread-1 (]: On model.elt.seasonal_trip_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.seasonal_trip_analysis"} */
create or replace transient table dev.analytics.seasonal_trip_analysis
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN EXTRACT(MONTH, starttime) IN (12, 1, 2) THEN 'Winter (Dec-Feb)'
        WHEN EXTRACT(MONTH, starttime) IN (3, 4, 5) THEN 'Spring (Mar-May)'
        WHEN EXTRACT(MONTH, starttime) IN (6, 7, 8) THEN 'Summer (Jun-Aug)'
        WHEN EXTRACT(MONTH, starttime) IN (9, 10, 11) THEN 'Fall (Sept-Nov)'
    END AS season,
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    season, load_timestamp
        );
[0m23:03:03.348393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:06.158336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.809 seconds
[0m23:03:06.172687 [debug] [Thread-1 (]: On model.elt.seasonal_trip_analysis: Close
[0m23:03:06.360608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a07ef0>]}
[0m23:03:06.362744 [info ] [Thread-1 (]: 2 of 7 OK created sql table model analytics.seasonal_trip_analysis ............. [[32mSUCCESS 1[0m in 3.03s]
[0m23:03:06.363914 [debug] [Thread-1 (]: Finished running node model.elt.seasonal_trip_analysis
[0m23:03:06.364670 [debug] [Thread-1 (]: Began running node model.elt.station_summary
[0m23:03:06.365433 [info ] [Thread-1 (]: 3 of 7 START sql table model analytics.station_summary ......................... [RUN]
[0m23:03:06.366225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.seasonal_trip_analysis, now model.elt.station_summary)
[0m23:03:06.367201 [debug] [Thread-1 (]: Began compiling node model.elt.station_summary
[0m23:03:06.375491 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.station_summary"
[0m23:03:06.377956 [debug] [Thread-1 (]: Began executing node model.elt.station_summary
[0m23:03:06.382784 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.station_summary"
[0m23:03:06.384212 [debug] [Thread-1 (]: Using snowflake connection "model.elt.station_summary"
[0m23:03:06.384698 [debug] [Thread-1 (]: On model.elt.station_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.station_summary"} */
create or replace transient table dev.analytics.station_summary
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    start_station_id,
    start_station_name,
    COUNT(*) AS total_trips_started,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    start_station_id, start_station_name, load_timestamp
        );
[0m23:03:06.385104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:08.512054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.126 seconds
[0m23:03:08.517368 [debug] [Thread-1 (]: On model.elt.station_summary: Close
[0m23:03:08.665408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a4bcb0>]}
[0m23:03:08.666383 [info ] [Thread-1 (]: 3 of 7 OK created sql table model analytics.station_summary .................... [[32mSUCCESS 1[0m in 2.30s]
[0m23:03:08.667171 [debug] [Thread-1 (]: Finished running node model.elt.station_summary
[0m23:03:08.667760 [debug] [Thread-1 (]: Began running node model.elt.trip_by_days_of_week
[0m23:03:08.668499 [info ] [Thread-1 (]: 4 of 7 START sql table model analytics.trip_by_days_of_week .................... [RUN]
[0m23:03:08.669205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.station_summary, now model.elt.trip_by_days_of_week)
[0m23:03:08.669703 [debug] [Thread-1 (]: Began compiling node model.elt.trip_by_days_of_week
[0m23:03:08.676029 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_by_days_of_week"
[0m23:03:08.677846 [debug] [Thread-1 (]: Began executing node model.elt.trip_by_days_of_week
[0m23:03:08.680675 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_by_days_of_week"
[0m23:03:08.682034 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_by_days_of_week"
[0m23:03:08.682468 [debug] [Thread-1 (]: On model.elt.trip_by_days_of_week: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_by_days_of_week"} */
create or replace transient table dev.analytics.trip_by_days_of_week
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    EXTRACT(DAYOFWEEK, starttime) AS day_of_week,
    COUNT(*) AS total_trips,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    day_of_week, load_timestamp
ORDER BY 
    day_of_week
        );
[0m23:03:08.682871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:10.695796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.012 seconds
[0m23:03:10.701686 [debug] [Thread-1 (]: On model.elt.trip_by_days_of_week: Close
[0m23:03:10.855854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141cdcfe0>]}
[0m23:03:10.857276 [info ] [Thread-1 (]: 4 of 7 OK created sql table model analytics.trip_by_days_of_week ............... [[32mSUCCESS 1[0m in 2.19s]
[0m23:03:10.858250 [debug] [Thread-1 (]: Finished running node model.elt.trip_by_days_of_week
[0m23:03:10.858821 [debug] [Thread-1 (]: Began running node model.elt.trip_duration_table
[0m23:03:10.859532 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics.trip_duration_table ..................... [RUN]
[0m23:03:10.860249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_by_days_of_week, now model.elt.trip_duration_table)
[0m23:03:10.860747 [debug] [Thread-1 (]: Began compiling node model.elt.trip_duration_table
[0m23:03:10.870621 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_duration_table"
[0m23:03:10.871534 [debug] [Thread-1 (]: Began executing node model.elt.trip_duration_table
[0m23:03:10.874269 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_duration_table"
[0m23:03:10.875855 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_duration_table"
[0m23:03:10.876312 [debug] [Thread-1 (]: On model.elt.trip_duration_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_duration_table"} */
create or replace transient table dev.analytics.trip_duration_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN tripduration < 300 THEN '0-5 mins'
        WHEN tripduration BETWEEN 300 AND 600 THEN '5-10 mins'
        WHEN tripduration BETWEEN 600 AND 1200 THEN '10-20 mins'
        WHEN tripduration BETWEEN 1200 AND 1800 THEN '20-30 mins'
        ELSE '30+ mins'
    END AS duration_range,
    COUNT(*) AS trip_count,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    duration_range, load_timestamp
ORDER BY 2 DESC
        );
[0m23:03:10.876722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:13.224550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.347 seconds
[0m23:03:13.232127 [debug] [Thread-1 (]: On model.elt.trip_duration_table: Close
[0m23:03:13.366696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136fddd00>]}
[0m23:03:13.369555 [info ] [Thread-1 (]: 5 of 7 OK created sql table model analytics.trip_duration_table ................ [[32mSUCCESS 1[0m in 2.51s]
[0m23:03:13.370993 [debug] [Thread-1 (]: Finished running node model.elt.trip_duration_table
[0m23:03:13.371527 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m23:03:13.372159 [info ] [Thread-1 (]: 6 of 7 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m23:03:13.372797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_duration_table, now model.elt.trip_summary_table)
[0m23:03:13.373220 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m23:03:13.382602 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m23:03:13.383426 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m23:03:13.385846 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m23:03:13.387381 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m23:03:13.387785 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour, load_timestamp
ORDER BY
    trip_hour
        );
[0m23:03:13.388151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:19.366949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.978 seconds
[0m23:03:19.373134 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m23:03:19.500498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141f41c10>]}
[0m23:03:19.502914 [info ] [Thread-1 (]: 6 of 7 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 6.13s]
[0m23:03:19.504466 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m23:03:19.505124 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m23:03:19.505869 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.user_demographic_table .................. [RUN]
[0m23:03:19.506565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m23:03:19.507051 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m23:03:19.516819 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m23:03:19.517767 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m23:03:19.522064 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m23:03:19.523440 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m23:03:19.523848 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    ROUND(AVG(birth_year)) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype, load_timestamp
        );
[0m23:03:19.524214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:21.209902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.685 seconds
[0m23:03:21.217849 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m23:03:21.395358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1898d200-8c55-481f-bc04-65051a781e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141ff7e60>]}
[0m23:03:21.397654 [info ] [Thread-1 (]: 7 of 7 OK created sql table model analytics.user_demographic_table ............. [[32mSUCCESS 1[0m in 1.89s]
[0m23:03:21.399130 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m23:03:21.400753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:21.401186 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m23:03:21.401676 [info ] [MainThread]: 
[0m23:03:21.402097 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 21.80 seconds (21.80s).
[0m23:03:21.404019 [debug] [MainThread]: Command end result
[0m23:03:21.437012 [info ] [MainThread]: 
[0m23:03:21.437570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:21.437831 [info ] [MainThread]: 
[0m23:03:21.438106 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:03:21.441177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.152395, "process_user_time": 3.266716, "process_kernel_time": 1.187632, "process_mem_max_rss": "199016448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:03:21.441536 [debug] [MainThread]: Command `dbt run` succeeded at 23:03:21.441470 after 23.15 seconds
[0m23:03:21.441801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053941a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10361fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137cbf770>]}
[0m23:03:21.442045 [debug] [MainThread]: Flushing usage events
[0m23:07:27.786471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104478830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10447bc50>]}


============================== 23:07:27.788526 | 098ef225-14e2-4f50-ac87-c45c17793b7e ==============================
[0m23:07:27.788526 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:07:27.788853 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/Users/parthmodi/.dbt', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'target_path': 'None', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt snapshot', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'write_json': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m23:07:28.749185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '098ef225-14e2-4f50-ac87-c45c17793b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047be6c0>]}
[0m23:07:28.772826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '098ef225-14e2-4f50-ac87-c45c17793b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ca060>]}
[0m23:07:28.773406 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:07:28.786743 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:07:28.871942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:07:28.872271 [debug] [MainThread]: Partial parsing: added file: elt://snapshots/snapshot_bike_summary_table.sql
[0m23:07:28.995767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '098ef225-14e2-4f50-ac87-c45c17793b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cbb90>]}
[0m23:07:29.069966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '098ef225-14e2-4f50-ac87-c45c17793b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105173350>]}
[0m23:07:29.070285 [info ] [MainThread]: Found 8 models, 1 snapshot, 8 sources, 459 macros
[0m23:07:29.073299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '098ef225-14e2-4f50-ac87-c45c17793b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1423e5010>]}
[0m23:07:29.074533 [info ] [MainThread]: 
[0m23:07:29.076459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:07:29.077352 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:07:29.087477 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:07:29.087681 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:07:29.087828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:29.811269 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.722 seconds
[0m23:07:29.816645 [debug] [ThreadPool]: On list_dev: Close
[0m23:07:29.964589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m23:07:29.976707 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:07:29.977169 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:07:29.977493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:30.702950 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.725 seconds
[0m23:07:30.708641 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:07:30.868806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshots)
[0m23:07:30.874628 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshots"
[0m23:07:30.875200 [debug] [ThreadPool]: On list_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_snapshots"} */
show objects in dev.snapshots limit 10000
[0m23:07:30.875583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:31.390301 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.514 seconds
[0m23:07:31.395859 [debug] [ThreadPool]: On list_dev_snapshots: Close
[0m23:07:31.536107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '098ef225-14e2-4f50-ac87-c45c17793b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1422f63c0>]}
[0m23:07:31.537921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:07:31.538414 [info ] [MainThread]: 
[0m23:07:31.543605 [debug] [Thread-1 (]: Began running node snapshot.elt.snapshot_bike_summary_table
[0m23:07:31.544528 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_bike_summary_table .................... [RUN]
[0m23:07:31.545195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshots, now snapshot.elt.snapshot_bike_summary_table)
[0m23:07:31.545663 [debug] [Thread-1 (]: Began compiling node snapshot.elt.snapshot_bike_summary_table
[0m23:07:31.556486 [debug] [Thread-1 (]: Began executing node snapshot.elt.snapshot_bike_summary_table
[0m23:07:31.614527 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m23:07:31.614861 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(bikeId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        

  

SELECT * FROM dev.analytics.bike_summary_table

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:07:31.615072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:32.054337 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8510b-0004-26b2-0002-587f000124be
[0m23:07:32.055057 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier 'TS'
[0m23:07:32.055767 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: Close
[0m23:07:32.204783 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bike_summary_table (snapshots/snapshot_bike_summary_table.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m23:07:32.206620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '098ef225-14e2-4f50-ac87-c45c17793b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae0800>]}
[0m23:07:32.207663 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.snapshot_bike_summary_table ................ [[31mERROR[0m in 0.66s]
[0m23:07:32.208393 [debug] [Thread-1 (]: Finished running node snapshot.elt.snapshot_bike_summary_table
[0m23:07:32.209809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:32.210211 [debug] [MainThread]: Connection 'snapshot.elt.snapshot_bike_summary_table' was properly closed.
[0m23:07:32.210550 [info ] [MainThread]: 
[0m23:07:32.210919 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m23:07:32.211610 [debug] [MainThread]: Command end result
[0m23:07:32.238189 [info ] [MainThread]: 
[0m23:07:32.238486 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:07:32.238690 [info ] [MainThread]: 
[0m23:07:32.238949 [error] [MainThread]:   Database Error in snapshot snapshot_bike_summary_table (snapshots/snapshot_bike_summary_table.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m23:07:32.239151 [info ] [MainThread]: 
[0m23:07:32.239352 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:07:32.241979 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.5113173, "process_user_time": 3.063646, "process_kernel_time": 0.7058, "process_mem_max_rss": "197836800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:07:32.242293 [debug] [MainThread]: Command `dbt snapshot` failed at 23:07:32.242240 after 4.51 seconds
[0m23:07:32.242529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10447a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550bfe0>]}
[0m23:07:32.242740 [debug] [MainThread]: Flushing usage events
[0m23:07:52.039102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfa5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfbd40>]}


============================== 23:07:52.040833 | a9187090-8f2d-48cd-b8e0-078e2258ee5c ==============================
[0m23:07:52.040833 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:07:52.041216 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt snapshot', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '/Users/parthmodi/.dbt', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m23:07:52.858269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9187090-8f2d-48cd-b8e0-078e2258ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfb740>]}
[0m23:07:52.881495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9187090-8f2d-48cd-b8e0-078e2258ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5ba7e0>]}
[0m23:07:52.882222 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:07:52.893544 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:07:52.984768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:52.985108 [debug] [MainThread]: Partial parsing: updated file: elt://snapshots/snapshot_bike_summary_table.sql
[0m23:07:53.101858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9187090-8f2d-48cd-b8e0-078e2258ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbb9880>]}
[0m23:07:53.148976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9187090-8f2d-48cd-b8e0-078e2258ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb7c380>]}
[0m23:07:53.149267 [info ] [MainThread]: Found 8 models, 1 snapshot, 8 sources, 459 macros
[0m23:07:53.149445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9187090-8f2d-48cd-b8e0-078e2258ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f930e60>]}
[0m23:07:53.150314 [info ] [MainThread]: 
[0m23:07:53.150631 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:07:53.151061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:07:53.157196 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:07:53.157381 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:07:53.157515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:53.776821 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.619 seconds
[0m23:07:53.783086 [debug] [ThreadPool]: On list_dev: Close
[0m23:07:53.974761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshots)
[0m23:07:53.987093 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshots"
[0m23:07:53.987529 [debug] [ThreadPool]: On list_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_snapshots"} */
show objects in dev.snapshots limit 10000
[0m23:07:53.987857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:54.541827 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.554 seconds
[0m23:07:54.546780 [debug] [ThreadPool]: On list_dev_snapshots: Close
[0m23:07:54.700767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshots, now list_dev_analytics)
[0m23:07:54.704655 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:07:54.705162 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:07:54.705576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:55.257290 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.551 seconds
[0m23:07:55.264436 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:07:55.390204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9187090-8f2d-48cd-b8e0-078e2258ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705a840>]}
[0m23:07:55.391136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:07:55.391597 [info ] [MainThread]: 
[0m23:07:55.394429 [debug] [Thread-1 (]: Began running node snapshot.elt.snapshot_bike_summary_table
[0m23:07:55.395151 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_bike_summary_table .................... [RUN]
[0m23:07:55.395732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.elt.snapshot_bike_summary_table)
[0m23:07:55.396177 [debug] [Thread-1 (]: Began compiling node snapshot.elt.snapshot_bike_summary_table
[0m23:07:55.406614 [debug] [Thread-1 (]: Began executing node snapshot.elt.snapshot_bike_summary_table
[0m23:07:55.463510 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m23:07:55.463840 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(bikeId as varchar ), '')
         || '|' || coalesce(cast(load_timestamp as varchar ), '')
        ) as dbt_scd_id,
        load_timestamp as dbt_updated_at,
        load_timestamp as dbt_valid_from,
        
  
  coalesce(nullif(load_timestamp, load_timestamp), null)
  as dbt_valid_to

    from (
        

  

SELECT * FROM dev.analytics.bike_summary_table

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:07:55.464048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:56.038319 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.574 seconds
[0m23:07:56.055610 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m23:07:56.056215 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m23:07:56.154835 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.098 seconds
[0m23:07:56.156105 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.elt.snapshot_bike_summary_table"
[0m23:07:56.159160 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m23:07:56.159779 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
create or replace transient table dev.snapshots.snapshot_bike_summary_table
         as
        (
    

    select *,
        md5(coalesce(cast(bikeId as varchar ), '')
         || '|' || coalesce(cast(load_timestamp as varchar ), '')
        ) as dbt_scd_id,
        load_timestamp as dbt_updated_at,
        load_timestamp as dbt_valid_from,
        
  
  coalesce(nullif(load_timestamp, load_timestamp), null)
  as dbt_valid_to

    from (
        

  

SELECT * FROM dev.analytics.bike_summary_table

    ) sbq



        );
[0m23:07:57.083115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.922 seconds
[0m23:07:57.117100 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: Close
[0m23:07:57.257104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9187090-8f2d-48cd-b8e0-078e2258ee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd64ce0>]}
[0m23:07:57.258541 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_bike_summary_table .................... [[32mSUCCESS 1[0m in 1.86s]
[0m23:07:57.259471 [debug] [Thread-1 (]: Finished running node snapshot.elt.snapshot_bike_summary_table
[0m23:07:57.261014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:57.261474 [debug] [MainThread]: Connection 'snapshot.elt.snapshot_bike_summary_table' was properly closed.
[0m23:07:57.261888 [info ] [MainThread]: 
[0m23:07:57.262320 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m23:07:57.263183 [debug] [MainThread]: Command end result
[0m23:07:57.295604 [info ] [MainThread]: 
[0m23:07:57.296024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:07:57.296295 [info ] [MainThread]: 
[0m23:07:57.296558 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:07:57.299633 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.3110943, "process_user_time": 3.089863, "process_kernel_time": 0.687888, "process_mem_max_rss": "198492160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:07:57.300014 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:07:57.299951 after 5.31 seconds
[0m23:07:57.300289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7b2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d83f50>]}
[0m23:07:57.300536 [debug] [MainThread]: Flushing usage events
[0m23:10:44.773468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6e540>]}


============================== 23:10:44.775436 | 7a02ed31-50fa-4e5d-91a0-847b20e782c2 ==============================
[0m23:10:44.775436 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:10:44.775792 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'invocation_command': 'dbt test', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/parthmodi/.dbt', 'static_parser': 'True', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m23:10:45.735094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a02ed31-50fa-4e5d-91a0-847b20e782c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe6b650>]}
[0m23:10:45.758087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a02ed31-50fa-4e5d-91a0-847b20e782c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6f6b0>]}
[0m23:10:45.758715 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:10:45.770344 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:10:45.860901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:10:45.861234 [debug] [MainThread]: Partial parsing: added file: elt://models/schema.yml
[0m23:10:45.984904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a02ed31-50fa-4e5d-91a0-847b20e782c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280cbad0>]}
[0m23:10:46.048265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a02ed31-50fa-4e5d-91a0-847b20e782c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1285b9790>]}
[0m23:10:46.048556 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 data tests, 8 sources, 459 macros
[0m23:10:46.048725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a02ed31-50fa-4e5d-91a0-847b20e782c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128190b30>]}
[0m23:10:46.049585 [info ] [MainThread]: 
[0m23:10:46.049893 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:46.052250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m23:10:46.059536 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:10:46.059724 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:10:46.059853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:46.734112 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.674 seconds
[0m23:10:46.742446 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:10:46.888950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshots)
[0m23:10:46.895889 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshots"
[0m23:10:46.896386 [debug] [ThreadPool]: On list_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_snapshots"} */
show objects in dev.snapshots limit 10000
[0m23:10:46.896803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:10:47.370159 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.473 seconds
[0m23:10:47.376946 [debug] [ThreadPool]: On list_dev_snapshots: Close
[0m23:10:47.503331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a02ed31-50fa-4e5d-91a0-847b20e782c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12800e420>]}
[0m23:10:47.504328 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:10:47.504790 [info ] [MainThread]: 
[0m23:10:47.508928 [debug] [Thread-1 (]: Began running node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m23:10:47.509571 [info ] [Thread-1 (]: 1 of 2 START test not_null_bike_summary_table_bikeId ........................... [RUN]
[0m23:10:47.510212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshots, now test.elt.not_null_bike_summary_table_bikeId.2cb1291f50)
[0m23:10:47.510700 [debug] [Thread-1 (]: Began compiling node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m23:10:47.531413 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"
[0m23:10:47.532470 [debug] [Thread-1 (]: Began executing node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m23:10:47.548852 [debug] [Thread-1 (]: Writing runtime sql for node "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"
[0m23:10:47.549914 [debug] [Thread-1 (]: Using snowflake connection "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"
[0m23:10:47.550202 [debug] [Thread-1 (]: On test.elt.not_null_bike_summary_table_bikeId.2cb1291f50: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select bikeId
from dev.analytics.bike_summary_table
where bikeId is null



      
    ) dbt_internal_test
[0m23:10:47.550464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:48.172729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m23:10:48.192440 [debug] [Thread-1 (]: On test.elt.not_null_bike_summary_table_bikeId.2cb1291f50: Close
[0m23:10:48.350772 [info ] [Thread-1 (]: 1 of 2 PASS not_null_bike_summary_table_bikeId ................................. [[32mPASS[0m in 0.84s]
[0m23:10:48.352396 [debug] [Thread-1 (]: Finished running node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m23:10:48.352968 [debug] [Thread-1 (]: Began running node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m23:10:48.353403 [info ] [Thread-1 (]: 2 of 2 START test unique_bike_summary_table_bikeId ............................. [RUN]
[0m23:10:48.354039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.elt.not_null_bike_summary_table_bikeId.2cb1291f50, now test.elt.unique_bike_summary_table_bikeId.47dbef4e35)
[0m23:10:48.354496 [debug] [Thread-1 (]: Began compiling node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m23:10:48.361976 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"
[0m23:10:48.362853 [debug] [Thread-1 (]: Began executing node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m23:10:48.365091 [debug] [Thread-1 (]: Writing runtime sql for node "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"
[0m23:10:48.366461 [debug] [Thread-1 (]: Using snowflake connection "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"
[0m23:10:48.366847 [debug] [Thread-1 (]: On test.elt.unique_bike_summary_table_bikeId.47dbef4e35: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    bikeId as unique_field,
    count(*) as n_records

from dev.analytics.bike_summary_table
where bikeId is not null
group by bikeId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:10:48.367205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:49.079160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.711 seconds
[0m23:10:49.086489 [debug] [Thread-1 (]: On test.elt.unique_bike_summary_table_bikeId.47dbef4e35: Close
[0m23:10:49.251415 [info ] [Thread-1 (]: 2 of 2 PASS unique_bike_summary_table_bikeId ................................... [[32mPASS[0m in 0.90s]
[0m23:10:49.252789 [debug] [Thread-1 (]: Finished running node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m23:10:49.256577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:49.257429 [debug] [MainThread]: Connection 'test.elt.unique_bike_summary_table_bikeId.47dbef4e35' was properly closed.
[0m23:10:49.258025 [info ] [MainThread]: 
[0m23:10:49.258572 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m23:10:49.259641 [debug] [MainThread]: Command end result
[0m23:10:49.294905 [info ] [MainThread]: 
[0m23:10:49.295358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:10:49.295620 [info ] [MainThread]: 
[0m23:10:49.295896 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:10:49.298921 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.579803, "process_user_time": 3.099888, "process_kernel_time": 0.673576, "process_mem_max_rss": "199507968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:10:49.299338 [debug] [MainThread]: Command `dbt test` succeeded at 23:10:49.299268 after 4.58 seconds
[0m23:10:49.299644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bb23f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ebc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c862e70>]}
[0m23:10:49.299911 [debug] [MainThread]: Flushing usage events
[0m23:11:11.254963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4c1d0>]}


============================== 23:11:11.256990 | e6e7ff14-4cc3-438e-89d7-46b121655564 ==============================
[0m23:11:11.256990 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:11:11.257328 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/Users/parthmodi/.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'empty': 'None', 'warn_error': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'indirect_selection': 'eager', 'static_parser': 'True'}
[0m23:11:12.065420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6e7ff14-4cc3-438e-89d7-46b121655564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123321ca0>]}
[0m23:11:12.088296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6e7ff14-4cc3-438e-89d7-46b121655564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235fef30>]}
[0m23:11:12.089599 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:11:12.100987 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:11:12.196885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:11:12.197201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:11:12.221099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6e7ff14-4cc3-438e-89d7-46b121655564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c011f0>]}
[0m23:11:12.235231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6e7ff14-4cc3-438e-89d7-46b121655564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1267c0fe0>]}
[0m23:11:12.235496 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 data tests, 8 sources, 459 macros
[0m23:11:12.235671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e7ff14-4cc3-438e-89d7-46b121655564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106452540>]}
[0m23:11:12.236681 [info ] [MainThread]: 
[0m23:11:12.237003 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:11:12.239197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m23:11:12.248771 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:11:12.248974 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:11:12.249114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:12.857960 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.608 seconds
[0m23:11:12.864137 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:11:12.991497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshots)
[0m23:11:12.996566 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshots"
[0m23:11:12.997049 [debug] [ThreadPool]: On list_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_snapshots"} */
show objects in dev.snapshots limit 10000
[0m23:11:12.997407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:13.553060 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.555 seconds
[0m23:11:13.558796 [debug] [ThreadPool]: On list_dev_snapshots: Close
[0m23:11:13.701550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e7ff14-4cc3-438e-89d7-46b121655564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b0e2d0>]}
[0m23:11:13.702681 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:11:13.703137 [info ] [MainThread]: 
[0m23:11:13.706255 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m23:11:13.706839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshots, now model.elt.trip_data)
[0m23:11:13.707290 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m23:11:13.718013 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m23:11:13.719222 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m23:11:13.720142 [debug] [Thread-1 (]: Began running node model.elt.bike_summary_table
[0m23:11:13.720613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.bike_summary_table)
[0m23:11:13.720966 [debug] [Thread-1 (]: Began compiling node model.elt.bike_summary_table
[0m23:11:13.726554 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.bike_summary_table"
[0m23:11:13.727245 [debug] [Thread-1 (]: Began executing node model.elt.bike_summary_table
[0m23:11:13.727840 [debug] [Thread-1 (]: Finished running node model.elt.bike_summary_table
[0m23:11:13.728193 [debug] [Thread-1 (]: Began running node model.elt.seasonal_trip_analysis
[0m23:11:13.728652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.bike_summary_table, now model.elt.seasonal_trip_analysis)
[0m23:11:13.728989 [debug] [Thread-1 (]: Began compiling node model.elt.seasonal_trip_analysis
[0m23:11:13.736268 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.seasonal_trip_analysis"
[0m23:11:13.737197 [debug] [Thread-1 (]: Began executing node model.elt.seasonal_trip_analysis
[0m23:11:13.737782 [debug] [Thread-1 (]: Finished running node model.elt.seasonal_trip_analysis
[0m23:11:13.738122 [debug] [Thread-1 (]: Began running node model.elt.station_summary
[0m23:11:13.738453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.seasonal_trip_analysis, now model.elt.station_summary)
[0m23:11:13.738714 [debug] [Thread-1 (]: Began compiling node model.elt.station_summary
[0m23:11:13.742849 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.station_summary"
[0m23:11:13.743794 [debug] [Thread-1 (]: Began executing node model.elt.station_summary
[0m23:11:13.744281 [debug] [Thread-1 (]: Finished running node model.elt.station_summary
[0m23:11:13.744555 [debug] [Thread-1 (]: Began running node model.elt.trip_by_days_of_week
[0m23:11:13.744827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.station_summary, now model.elt.trip_by_days_of_week)
[0m23:11:13.745048 [debug] [Thread-1 (]: Began compiling node model.elt.trip_by_days_of_week
[0m23:11:13.748211 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_by_days_of_week"
[0m23:11:13.748807 [debug] [Thread-1 (]: Began executing node model.elt.trip_by_days_of_week
[0m23:11:13.749255 [debug] [Thread-1 (]: Finished running node model.elt.trip_by_days_of_week
[0m23:11:13.749540 [debug] [Thread-1 (]: Began running node model.elt.trip_duration_table
[0m23:11:13.749797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_by_days_of_week, now model.elt.trip_duration_table)
[0m23:11:13.750023 [debug] [Thread-1 (]: Began compiling node model.elt.trip_duration_table
[0m23:11:13.754713 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_duration_table"
[0m23:11:13.755308 [debug] [Thread-1 (]: Began executing node model.elt.trip_duration_table
[0m23:11:13.755689 [debug] [Thread-1 (]: Finished running node model.elt.trip_duration_table
[0m23:11:13.755933 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m23:11:13.756160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_duration_table, now model.elt.trip_summary_table)
[0m23:11:13.756348 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m23:11:13.761055 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m23:11:13.761587 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m23:11:13.761974 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m23:11:13.762203 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m23:11:13.762406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m23:11:13.762582 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m23:11:13.766925 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m23:11:13.767502 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m23:11:13.767856 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m23:11:13.768077 [debug] [Thread-1 (]: Began running node snapshot.elt.snapshot_bike_summary_table
[0m23:11:13.768283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.user_demographic_table, now snapshot.elt.snapshot_bike_summary_table)
[0m23:11:13.768461 [debug] [Thread-1 (]: Began compiling node snapshot.elt.snapshot_bike_summary_table
[0m23:11:13.770242 [debug] [Thread-1 (]: Began executing node snapshot.elt.snapshot_bike_summary_table
[0m23:11:13.770577 [debug] [Thread-1 (]: Finished running node snapshot.elt.snapshot_bike_summary_table
[0m23:11:13.770779 [debug] [Thread-1 (]: Began running node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m23:11:13.770969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.elt.snapshot_bike_summary_table, now test.elt.not_null_bike_summary_table_bikeId.2cb1291f50)
[0m23:11:13.771134 [debug] [Thread-1 (]: Began compiling node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m23:11:13.778405 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"
[0m23:11:13.778790 [debug] [Thread-1 (]: Began executing node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m23:11:13.779128 [debug] [Thread-1 (]: Finished running node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m23:11:13.779327 [debug] [Thread-1 (]: Began running node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m23:11:13.779515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.elt.not_null_bike_summary_table_bikeId.2cb1291f50, now test.elt.unique_bike_summary_table_bikeId.47dbef4e35)
[0m23:11:13.779672 [debug] [Thread-1 (]: Began compiling node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m23:11:13.782721 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"
[0m23:11:13.783060 [debug] [Thread-1 (]: Began executing node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m23:11:13.783366 [debug] [Thread-1 (]: Finished running node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m23:11:13.783811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:13.783984 [debug] [MainThread]: Connection 'test.elt.unique_bike_summary_table_bikeId.47dbef4e35' was properly closed.
[0m23:11:13.784751 [debug] [MainThread]: Command end result
[0m23:11:13.833243 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m23:11:13.833420 [info ] [MainThread]: Building catalog
[0m23:11:13.838046 [debug] [ThreadPool]: Acquiring new snowflake connection 'dev.information_schema'
[0m23:11:13.845501 [debug] [ThreadPool]: Using snowflake connection "dev.information_schema"
[0m23:11:13.845847 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "dev.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from dev.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'trip_data' and upper("table_name") = upper('trip_data')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trip_duration_table' and upper("table_name") = upper('trip_duration_table')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'bike_summary_table' and upper("table_name") = upper('bike_summary_table')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trip_summary_table' and upper("table_name") = upper('trip_summary_table')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'seasonal_trip_analysis' and upper("table_name") = upper('seasonal_trip_analysis')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'snapshot_bike_summary_table' and upper("table_name") = upper('snapshot_bike_summary_table')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'station_summary' and upper("table_name") = upper('station_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'user_demographic_table' and upper("table_name") = upper('user_demographic_table')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trip_by_days_of_week' and upper("table_name") = upper('trip_by_days_of_week')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from dev.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'trip_data' and upper("table_name") = upper('trip_data')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trip_duration_table' and upper("table_name") = upper('trip_duration_table')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'bike_summary_table' and upper("table_name") = upper('bike_summary_table')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trip_summary_table' and upper("table_name") = upper('trip_summary_table')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'seasonal_trip_analysis' and upper("table_name") = upper('seasonal_trip_analysis')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'snapshot_bike_summary_table' and upper("table_name") = upper('snapshot_bike_summary_table')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'station_summary' and upper("table_name") = upper('station_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'user_demographic_table' and upper("table_name") = upper('user_demographic_table')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trip_by_days_of_week' and upper("table_name") = upper('trip_by_days_of_week')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m23:11:13.846147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:18.102179 [debug] [ThreadPool]: SQL status: SUCCESS 63 in 4.256 seconds
[0m23:11:18.125562 [debug] [ThreadPool]: On dev.information_schema: Close
[0m23:11:18.329476 [info ] [MainThread]: Catalog written to /Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/target/catalog.json
[0m23:11:18.332856 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 7.1300216, "process_user_time": 2.883328, "process_kernel_time": 0.692961, "process_mem_max_rss": "196034560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:11:18.333256 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:11:18.333193 after 7.13 seconds
[0m23:11:18.333472 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:11:18.333636 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m23:11:18.333835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c892b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c89550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c02870>]}
[0m23:11:18.334043 [debug] [MainThread]: Flushing usage events
[0m23:11:32.755971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108793230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083eaed0>]}


============================== 23:11:32.758304 | df4197d2-bafc-414c-b28d-d016b39dc3dc ==============================
[0m23:11:32.758304 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:11:32.758662 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve', 'profiles_dir': '/Users/parthmodi/.dbt', 'no_print': 'None', 'empty': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'version_check': 'True', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False'}
[0m23:11:33.599483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df4197d2-bafc-414c-b28d-d016b39dc3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3d1640>]}
[0m23:11:33.622462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df4197d2-bafc-414c-b28d-d016b39dc3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b36fc0>]}
[0m23:28:07.884111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10351eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10351ff80>]}


============================== 23:28:07.886276 | 97cbb457-eac3-462b-819e-0f49995644a8 ==============================
[0m23:28:07.886276 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:28:07.886730 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'use_colors': 'True', 'empty': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt clean', 'printer_width': '80', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/parthmodi/Desktop/DATA 226/sjsu-data226/lab2/elt/logs'}
[0m23:28:07.994246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97cbb457-eac3-462b-819e-0f49995644a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103797170>]}
[0m23:28:08.013132 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18374446, "process_user_time": 0.679001, "process_kernel_time": 0.1564, "process_mem_max_rss": "99516416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:28:08.013530 [debug] [MainThread]: Command `dbt clean` succeeded at 23:28:08.013474 after 0.18 seconds
[0m23:28:08.013764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104609e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103797170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043224e0>]}
[0m23:28:08.013956 [debug] [MainThread]: Flushing usage events
[0m18:51:34.464109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97fb1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f24920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f8a1b0>]}


============================== 18:51:34.486954 | 214a0fd8-603e-4be0-9434-79055e7eb9a7 ==============================
[0m18:51:34.486954 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:51:34.491325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:35.979218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97752f60>]}
[0m18:51:36.028791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb0f9e0>]}
[0m18:51:36.029795 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:51:36.129736 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:51:36.130629 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:51:36.131300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77fa4410>]}
[0m18:51:36.897634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff779f2c00>]}
[0m18:51:37.142444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff771465d0>]}
[0m18:51:37.142963 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 data tests, 8 sources, 459 macros
[0m18:51:37.145242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9963d940>]}
[0m18:51:37.146588 [info ] [MainThread]: 
[0m18:51:37.147235 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:51:37.149871 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m18:51:37.159397 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m18:51:37.160018 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m18:51:37.160349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:38.396863 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.236 seconds
[0m18:51:38.406520 [debug] [ThreadPool]: On list_dev: Close
[0m18:51:38.638304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m18:51:38.664224 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m18:51:38.664772 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m18:51:38.665093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:39.779102 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.114 seconds
[0m18:51:39.785697 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m18:51:39.945854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshots)
[0m18:51:39.951486 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshots"
[0m18:51:39.952099 [debug] [ThreadPool]: On list_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_snapshots"} */
show objects in dev.snapshots limit 10000
[0m18:51:39.952640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:40.469786 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.517 seconds
[0m18:51:40.481789 [debug] [ThreadPool]: On list_dev_snapshots: Close
[0m18:51:40.611368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99604a40>]}
[0m18:51:40.613971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:40.618877 [info ] [MainThread]: 
[0m18:51:40.632473 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m18:51:40.633156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshots, now model.elt.trip_data)
[0m18:51:40.633656 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m18:51:40.639442 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m18:51:40.642093 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m18:51:40.643375 [debug] [Thread-1 (]: Began running node model.elt.bike_summary_table
[0m18:51:40.643760 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics.bike_summary_table ...................... [RUN]
[0m18:51:40.644417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.bike_summary_table)
[0m18:51:40.644690 [debug] [Thread-1 (]: Began compiling node model.elt.bike_summary_table
[0m18:51:40.648017 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.bike_summary_table"
[0m18:51:40.649105 [debug] [Thread-1 (]: Began executing node model.elt.bike_summary_table
[0m18:51:40.666296 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.bike_summary_table"
[0m18:51:40.668922 [debug] [Thread-1 (]: Using snowflake connection "model.elt.bike_summary_table"
[0m18:51:40.669242 [debug] [Thread-1 (]: On model.elt.bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.bike_summary_table"} */
create or replace transient table dev.analytics.bike_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    bikeid,
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    bikeid, load_timestamp
ORDER BY 
    total_trips DESC
        );
[0m18:51:40.669524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:44.282016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.610 seconds
[0m18:51:44.322383 [debug] [Thread-1 (]: On model.elt.bike_summary_table: Close
[0m18:51:44.471959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2aff20>]}
[0m18:51:44.474096 [info ] [Thread-1 (]: 1 of 7 OK created sql table model analytics.bike_summary_table ................. [[32mSUCCESS 1[0m in 3.82s]
[0m18:51:44.483883 [debug] [Thread-1 (]: Finished running node model.elt.bike_summary_table
[0m18:51:44.489160 [debug] [Thread-1 (]: Began running node model.elt.seasonal_trip_analysis
[0m18:51:44.493500 [info ] [Thread-1 (]: 2 of 7 START sql table model analytics.seasonal_trip_analysis .................. [RUN]
[0m18:51:44.494578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.bike_summary_table, now model.elt.seasonal_trip_analysis)
[0m18:51:44.495639 [debug] [Thread-1 (]: Began compiling node model.elt.seasonal_trip_analysis
[0m18:51:44.524787 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.seasonal_trip_analysis"
[0m18:51:44.528844 [debug] [Thread-1 (]: Began executing node model.elt.seasonal_trip_analysis
[0m18:51:44.534817 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.seasonal_trip_analysis"
[0m18:51:44.537547 [debug] [Thread-1 (]: Using snowflake connection "model.elt.seasonal_trip_analysis"
[0m18:51:44.537923 [debug] [Thread-1 (]: On model.elt.seasonal_trip_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.seasonal_trip_analysis"} */
create or replace transient table dev.analytics.seasonal_trip_analysis
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN EXTRACT(MONTH, starttime) IN (12, 1, 2) THEN 'Winter (Dec-Feb)'
        WHEN EXTRACT(MONTH, starttime) IN (3, 4, 5) THEN 'Spring (Mar-May)'
        WHEN EXTRACT(MONTH, starttime) IN (6, 7, 8) THEN 'Summer (Jun-Aug)'
        WHEN EXTRACT(MONTH, starttime) IN (9, 10, 11) THEN 'Fall (Sept-Nov)'
    END AS season,
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    season, load_timestamp
        );
[0m18:51:44.538343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:47.582756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.040 seconds
[0m18:51:47.601701 [debug] [Thread-1 (]: On model.elt.seasonal_trip_analysis: Close
[0m18:51:47.730283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c67710>]}
[0m18:51:47.733218 [info ] [Thread-1 (]: 2 of 7 OK created sql table model analytics.seasonal_trip_analysis ............. [[32mSUCCESS 1[0m in 3.23s]
[0m18:51:47.735450 [debug] [Thread-1 (]: Finished running node model.elt.seasonal_trip_analysis
[0m18:51:47.737503 [debug] [Thread-1 (]: Began running node model.elt.station_summary
[0m18:51:47.738764 [info ] [Thread-1 (]: 3 of 7 START sql table model analytics.station_summary ......................... [RUN]
[0m18:51:47.739660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.seasonal_trip_analysis, now model.elt.station_summary)
[0m18:51:47.740270 [debug] [Thread-1 (]: Began compiling node model.elt.station_summary
[0m18:51:47.750727 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.station_summary"
[0m18:51:47.752414 [debug] [Thread-1 (]: Began executing node model.elt.station_summary
[0m18:51:47.755413 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.station_summary"
[0m18:51:47.758039 [debug] [Thread-1 (]: Using snowflake connection "model.elt.station_summary"
[0m18:51:47.758460 [debug] [Thread-1 (]: On model.elt.station_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.station_summary"} */
create or replace transient table dev.analytics.station_summary
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    start_station_id,
    start_station_name,
    COUNT(*) AS total_trips_started,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    start_station_id, start_station_name, load_timestamp
        );
[0m18:51:47.758806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:50.823211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.064 seconds
[0m18:51:50.828414 [debug] [Thread-1 (]: On model.elt.station_summary: Close
[0m18:51:51.017147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d65a450>]}
[0m18:51:51.019076 [info ] [Thread-1 (]: 3 of 7 OK created sql table model analytics.station_summary .................... [[32mSUCCESS 1[0m in 3.28s]
[0m18:51:51.021916 [debug] [Thread-1 (]: Finished running node model.elt.station_summary
[0m18:51:51.023128 [debug] [Thread-1 (]: Began running node model.elt.trip_by_days_of_week
[0m18:51:51.024279 [info ] [Thread-1 (]: 4 of 7 START sql table model analytics.trip_by_days_of_week .................... [RUN]
[0m18:51:51.025831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.station_summary, now model.elt.trip_by_days_of_week)
[0m18:51:51.026647 [debug] [Thread-1 (]: Began compiling node model.elt.trip_by_days_of_week
[0m18:51:51.033843 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_by_days_of_week"
[0m18:51:51.036117 [debug] [Thread-1 (]: Began executing node model.elt.trip_by_days_of_week
[0m18:51:51.039464 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_by_days_of_week"
[0m18:51:51.042251 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_by_days_of_week"
[0m18:51:51.043169 [debug] [Thread-1 (]: On model.elt.trip_by_days_of_week: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_by_days_of_week"} */
create or replace transient table dev.analytics.trip_by_days_of_week
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    EXTRACT(DAYOFWEEK, starttime) AS day_of_week,
    COUNT(*) AS total_trips,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    day_of_week, load_timestamp
ORDER BY 
    day_of_week
        );
[0m18:51:51.043812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:53.128097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.076 seconds
[0m18:51:53.153615 [debug] [Thread-1 (]: On model.elt.trip_by_days_of_week: Close
[0m18:51:53.295375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77146390>]}
[0m18:51:53.297830 [info ] [Thread-1 (]: 4 of 7 OK created sql table model analytics.trip_by_days_of_week ............... [[32mSUCCESS 1[0m in 2.27s]
[0m18:51:53.300420 [debug] [Thread-1 (]: Finished running node model.elt.trip_by_days_of_week
[0m18:51:53.301620 [debug] [Thread-1 (]: Began running node model.elt.trip_duration_table
[0m18:51:53.303085 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics.trip_duration_table ..................... [RUN]
[0m18:51:53.304442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_by_days_of_week, now model.elt.trip_duration_table)
[0m18:51:53.305092 [debug] [Thread-1 (]: Began compiling node model.elt.trip_duration_table
[0m18:51:53.327069 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_duration_table"
[0m18:51:53.331915 [debug] [Thread-1 (]: Began executing node model.elt.trip_duration_table
[0m18:51:53.335819 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_duration_table"
[0m18:51:53.339430 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_duration_table"
[0m18:51:53.340748 [debug] [Thread-1 (]: On model.elt.trip_duration_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_duration_table"} */
create or replace transient table dev.analytics.trip_duration_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN tripduration < 300 THEN '0-5 mins'
        WHEN tripduration BETWEEN 300 AND 600 THEN '5-10 mins'
        WHEN tripduration BETWEEN 600 AND 1200 THEN '10-20 mins'
        WHEN tripduration BETWEEN 1200 AND 1800 THEN '20-30 mins'
        ELSE '30+ mins'
    END AS duration_range,
    COUNT(*) AS trip_count,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    duration_range, load_timestamp
ORDER BY 2 DESC
        );
[0m18:51:53.341815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:55.614681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.271 seconds
[0m18:51:55.637142 [debug] [Thread-1 (]: On model.elt.trip_duration_table: Close
[0m18:51:55.752324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76d74320>]}
[0m18:51:55.753541 [info ] [Thread-1 (]: 5 of 7 OK created sql table model analytics.trip_duration_table ................ [[32mSUCCESS 1[0m in 2.45s]
[0m18:51:55.754545 [debug] [Thread-1 (]: Finished running node model.elt.trip_duration_table
[0m18:51:55.755425 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m18:51:55.756532 [info ] [Thread-1 (]: 6 of 7 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m18:51:55.757383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_duration_table, now model.elt.trip_summary_table)
[0m18:51:55.757865 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m18:51:55.768622 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m18:51:55.770041 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m18:51:55.772011 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m18:51:55.773445 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m18:51:55.773765 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour, load_timestamp
ORDER BY
    trip_hour
        );
[0m18:51:55.774063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:01.514756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.737 seconds
[0m18:52:01.528932 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m18:52:01.677503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76d545c0>]}
[0m18:52:01.679609 [info ] [Thread-1 (]: 6 of 7 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 5.92s]
[0m18:52:01.684172 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m18:52:01.685538 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m18:52:01.687048 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.user_demographic_table .................. [RUN]
[0m18:52:01.687826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m18:52:01.688215 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m18:52:01.702062 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m18:52:01.703427 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m18:52:01.705718 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m18:52:01.707350 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m18:52:01.707682 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    ROUND(AVG(birth_year)) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype, load_timestamp
        );
[0m18:52:01.708061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:04.234671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.523 seconds
[0m18:52:04.250466 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m18:52:04.390195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214a0fd8-603e-4be0-9434-79055e7eb9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b79310>]}
[0m18:52:04.391579 [info ] [Thread-1 (]: 7 of 7 OK created sql table model analytics.user_demographic_table ............. [[32mSUCCESS 1[0m in 2.70s]
[0m18:52:04.396194 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m18:52:04.401921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:04.402550 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m18:52:04.403584 [info ] [MainThread]: 
[0m18:52:04.404523 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 27.26 seconds (27.26s).
[0m18:52:04.407228 [debug] [MainThread]: Command end result
[0m18:52:04.453531 [info ] [MainThread]: 
[0m18:52:04.454266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:04.454665 [info ] [MainThread]: 
[0m18:52:04.455184 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:52:04.458015 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.065521, "process_user_time": 5.517604, "process_kernel_time": 0.647282, "process_mem_max_rss": "209404", "process_in_blocks": "43224", "process_out_blocks": "10434"}
[0m18:52:04.459081 [debug] [MainThread]: Command `dbt run` succeeded at 18:52:04.458975 after 30.07 seconds
[0m18:52:04.459703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982aecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982eb170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982ea750>]}
[0m18:52:04.460048 [debug] [MainThread]: Flushing usage events
[0m18:52:09.104148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dcfc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df1ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dcfc590>]}


============================== 18:52:09.108428 | 5464f2c3-c0cc-42d6-b25a-f62dd45a3d6c ==============================
[0m18:52:09.108428 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:52:09.109857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:52:09.702739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5464f2c3-c0cc-42d6-b25a-f62dd45a3d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff685f0ce0>]}
[0m18:52:09.730093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5464f2c3-c0cc-42d6-b25a-f62dd45a3d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd53590>]}
[0m18:52:09.731008 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:52:09.784105 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:52:09.856849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:09.857177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:09.882142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5464f2c3-c0cc-42d6-b25a-f62dd45a3d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61b644d0>]}
[0m18:52:09.965180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5464f2c3-c0cc-42d6-b25a-f62dd45a3d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6161dc70>]}
[0m18:52:09.965713 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 data tests, 8 sources, 459 macros
[0m18:52:09.966542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5464f2c3-c0cc-42d6-b25a-f62dd45a3d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61b666c0>]}
[0m18:52:09.967957 [info ] [MainThread]: 
[0m18:52:09.968661 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:52:09.971535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshots'
[0m18:52:09.981077 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshots"
[0m18:52:09.981418 [debug] [ThreadPool]: On list_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_snapshots"} */
show objects in dev.snapshots limit 10000
[0m18:52:09.981666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:10.588036 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.606 seconds
[0m18:52:10.590799 [debug] [ThreadPool]: On list_dev_snapshots: Close
[0m18:52:10.753557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshots, now list_dev_analytics)
[0m18:52:10.756714 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m18:52:10.757162 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m18:52:10.757618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:11.520757 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.763 seconds
[0m18:52:11.524873 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m18:52:11.682562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5464f2c3-c0cc-42d6-b25a-f62dd45a3d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6188dc10>]}
[0m18:52:11.684052 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:11.687966 [info ] [MainThread]: 
[0m18:52:11.731943 [debug] [Thread-1 (]: Began running node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m18:52:11.733250 [info ] [Thread-1 (]: 1 of 2 START test not_null_bike_summary_table_bikeId ........................... [RUN]
[0m18:52:11.734529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.elt.not_null_bike_summary_table_bikeId.2cb1291f50)
[0m18:52:11.735038 [debug] [Thread-1 (]: Began compiling node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m18:52:11.749820 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"
[0m18:52:11.751947 [debug] [Thread-1 (]: Began executing node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m18:52:11.778173 [debug] [Thread-1 (]: Writing runtime sql for node "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"
[0m18:52:11.779722 [debug] [Thread-1 (]: Using snowflake connection "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"
[0m18:52:11.780028 [debug] [Thread-1 (]: On test.elt.not_null_bike_summary_table_bikeId.2cb1291f50: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select bikeId
from dev.analytics.bike_summary_table
where bikeId is null



      
    ) dbt_internal_test
[0m18:52:11.780347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:12.642710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m18:52:12.663265 [debug] [Thread-1 (]: On test.elt.not_null_bike_summary_table_bikeId.2cb1291f50: Close
[0m18:52:12.803549 [info ] [Thread-1 (]: 1 of 2 PASS not_null_bike_summary_table_bikeId ................................. [[32mPASS[0m in 1.07s]
[0m18:52:12.807151 [debug] [Thread-1 (]: Finished running node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m18:52:12.807807 [debug] [Thread-1 (]: Began running node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m18:52:12.808460 [info ] [Thread-1 (]: 2 of 2 START test unique_bike_summary_table_bikeId ............................. [RUN]
[0m18:52:12.809300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.elt.not_null_bike_summary_table_bikeId.2cb1291f50, now test.elt.unique_bike_summary_table_bikeId.47dbef4e35)
[0m18:52:12.809688 [debug] [Thread-1 (]: Began compiling node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m18:52:12.816025 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"
[0m18:52:12.817384 [debug] [Thread-1 (]: Began executing node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m18:52:12.819167 [debug] [Thread-1 (]: Writing runtime sql for node "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"
[0m18:52:12.820474 [debug] [Thread-1 (]: Using snowflake connection "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"
[0m18:52:12.820828 [debug] [Thread-1 (]: On test.elt.unique_bike_summary_table_bikeId.47dbef4e35: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    bikeId as unique_field,
    count(*) as n_records

from dev.analytics.bike_summary_table
where bikeId is not null
group by bikeId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:52:12.821153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:13.407250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m18:52:13.418480 [debug] [Thread-1 (]: On test.elt.unique_bike_summary_table_bikeId.47dbef4e35: Close
[0m18:52:13.578850 [info ] [Thread-1 (]: 2 of 2 PASS unique_bike_summary_table_bikeId ................................... [[32mPASS[0m in 0.77s]
[0m18:52:13.581255 [debug] [Thread-1 (]: Finished running node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m18:52:13.586098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:13.586765 [debug] [MainThread]: Connection 'test.elt.unique_bike_summary_table_bikeId.47dbef4e35' was properly closed.
[0m18:52:13.588762 [info ] [MainThread]: 
[0m18:52:13.591332 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m18:52:13.593924 [debug] [MainThread]: Command end result
[0m18:52:13.671753 [info ] [MainThread]: 
[0m18:52:13.672963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:13.673595 [info ] [MainThread]: 
[0m18:52:13.674413 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:52:13.677319 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.6212125, "process_user_time": 2.906283, "process_kernel_time": 0.362645, "process_mem_max_rss": "207192", "process_in_blocks": "1968", "process_out_blocks": "1939"}
[0m18:52:13.678269 [debug] [MainThread]: Command `dbt test` succeeded at 18:52:13.678153 after 4.62 seconds
[0m18:52:13.679126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dcbf680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9d9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9d8da0>]}
[0m18:52:13.679711 [debug] [MainThread]: Flushing usage events
[0m18:52:17.001063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31eede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31ef3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b704a0>]}


============================== 18:52:17.005862 | 813936d7-b378-4c36-9a82-7eb22b2620a8 ==============================
[0m18:52:17.005862 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:52:17.009175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:17.637310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '813936d7-b378-4c36-9a82-7eb22b2620a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7516a20>]}
[0m18:52:17.673478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '813936d7-b378-4c36-9a82-7eb22b2620a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832ff2c0>]}
[0m18:52:17.674522 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:52:17.733657 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:52:17.816452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:17.817097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:17.848232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '813936d7-b378-4c36-9a82-7eb22b2620a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c60950>]}
[0m18:52:17.913048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '813936d7-b378-4c36-9a82-7eb22b2620a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8296a180>]}
[0m18:52:17.913476 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 data tests, 8 sources, 459 macros
[0m18:52:17.914104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813936d7-b378-4c36-9a82-7eb22b2620a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c89af0>]}
[0m18:52:17.915577 [info ] [MainThread]: 
[0m18:52:17.916265 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:52:17.916935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m18:52:17.925087 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m18:52:17.925399 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m18:52:17.925644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:18.560733 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.635 seconds
[0m18:52:18.565609 [debug] [ThreadPool]: On list_dev: Close
[0m18:52:18.753604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m18:52:18.759497 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m18:52:18.759898 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m18:52:18.760189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:19.236236 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.476 seconds
[0m18:52:19.242133 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m18:52:19.382114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshots)
[0m18:52:19.388787 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshots"
[0m18:52:19.389553 [debug] [ThreadPool]: On list_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_snapshots"} */
show objects in dev.snapshots limit 10000
[0m18:52:19.390267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:19.963519 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.573 seconds
[0m18:52:19.965994 [debug] [ThreadPool]: On list_dev_snapshots: Close
[0m18:52:20.138497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813936d7-b378-4c36-9a82-7eb22b2620a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829926c0>]}
[0m18:52:20.140494 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:20.143188 [info ] [MainThread]: 
[0m18:52:20.159307 [debug] [Thread-1 (]: Began running node snapshot.elt.snapshot_bike_summary_table
[0m18:52:20.160495 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_bike_summary_table .................... [RUN]
[0m18:52:20.161689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshots, now snapshot.elt.snapshot_bike_summary_table)
[0m18:52:20.162324 [debug] [Thread-1 (]: Began compiling node snapshot.elt.snapshot_bike_summary_table
[0m18:52:20.172233 [debug] [Thread-1 (]: Began executing node snapshot.elt.snapshot_bike_summary_table
[0m18:52:20.217750 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:20.218404 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
describe table "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE"
[0m18:52:20.218889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:20.707830 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.489 seconds
[0m18:52:20.737163 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:20.737682 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
create or replace temporary table "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE__dbt_tmp"
         as
        (

    with snapshot_query as (

        

  

SELECT * FROM dev.analytics.bike_summary_table


    ),

    snapshotted_data as (

        select *, 
    
        bikeId as dbt_unique_key
    

        from "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        bikeId as dbt_unique_key
    
,
            load_timestamp as dbt_updated_at,
            load_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(load_timestamp, load_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(bikeId as varchar ), '')
         || '|' || coalesce(cast(load_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        bikeId as dbt_unique_key
    
,
            load_timestamp as dbt_updated_at,
            load_timestamp as dbt_valid_from,
            load_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        bikeId as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.load_timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_timestamp)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:52:22.061881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.323 seconds
[0m18:52:22.071433 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:22.072471 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
describe table "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE__dbt_tmp"
[0m18:52:22.209308 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.136 seconds
[0m18:52:22.215655 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:22.216583 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
describe table "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE"
[0m18:52:22.331685 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.113 seconds
[0m18:52:22.343065 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:22.344209 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
describe table "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE__dbt_tmp"
[0m18:52:22.465546 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.120 seconds
[0m18:52:22.473359 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:22.474361 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
describe table "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE"
[0m18:52:22.628089 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.152 seconds
[0m18:52:22.642812 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:22.643765 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
describe table "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE__dbt_tmp"
[0m18:52:22.756520 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.112 seconds
[0m18:52:22.775065 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:22.775905 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
select * from (
        

    with snapshot_query as (

        

  

SELECT * FROM dev.analytics.bike_summary_table


    ),

    snapshotted_data as (

        select *, 
    
        bikeId as dbt_unique_key
    

        from "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        bikeId as dbt_unique_key
    
,
            load_timestamp as dbt_updated_at,
            load_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(load_timestamp, load_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(bikeId as varchar ), '')
         || '|' || coalesce(cast(load_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        bikeId as dbt_unique_key
    
,
            load_timestamp as dbt_updated_at,
            load_timestamp as dbt_valid_from,
            load_timestamp as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        bikeId as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.load_timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.load_timestamp)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:52:23.081998 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.305 seconds
[0m18:52:23.087338 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:23.087994 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:52:23.187218 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.098 seconds
[0m18:52:23.189897 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:23.196207 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:23.197145 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
BEGIN
[0m18:52:23.396697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m18:52:23.398538 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:23.400164 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
merge into "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOTS"."SNAPSHOT_BIKE_SUMMARY_TABLE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("BIKEID", "TOTAL_TRIPS", "AVG_TRIP_DURATION", "TOTAL_TRIP_DURATION", "LOAD_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("BIKEID", "TOTAL_TRIPS", "AVG_TRIP_DURATION", "TOTAL_TRIP_DURATION", "LOAD_TIMESTAMP", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:52:24.421224 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.019 seconds
[0m18:52:24.424040 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:52:24.425442 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
COMMIT
[0m18:52:24.836882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m18:52:24.864338 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: Close
[0m18:52:25.013938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813936d7-b378-4c36-9a82-7eb22b2620a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fb46b0>]}
[0m18:52:25.018828 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_bike_summary_table .................... [[32mSUCCESS 0[0m in 4.85s]
[0m18:52:25.024153 [debug] [Thread-1 (]: Finished running node snapshot.elt.snapshot_bike_summary_table
[0m18:52:25.027713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:25.028201 [debug] [MainThread]: Connection 'snapshot.elt.snapshot_bike_summary_table' was properly closed.
[0m18:52:25.029162 [info ] [MainThread]: 
[0m18:52:25.030087 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.11 seconds (7.11s).
[0m18:52:25.031607 [debug] [MainThread]: Command end result
[0m18:52:25.064839 [info ] [MainThread]: 
[0m18:52:25.065549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:25.066005 [info ] [MainThread]: 
[0m18:52:25.066432 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:52:25.068626 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.122183, "process_user_time": 3.056865, "process_kernel_time": 0.401232, "process_mem_max_rss": "205232", "process_in_blocks": "8", "process_out_blocks": "1956"}
[0m18:52:25.069289 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:52:25.069219 after 8.12 seconds
[0m18:52:25.069908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7516a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82daa300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82da9f70>]}
[0m18:52:25.070294 [debug] [MainThread]: Flushing usage events
[0m18:55:13.093484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc11ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac5cede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac5cdd00>]}


============================== 18:55:13.098259 | c36d1848-a1b0-43ad-b709-697b01414cd8 ==============================
[0m18:55:13.098259 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:55:13.102075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:55:13.671480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7ef140>]}
[0m18:55:13.706788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada7b7a0>]}
[0m18:55:13.707604 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:55:13.774838 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:55:13.881077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:13.881567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:13.926928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90296c60>]}
[0m18:55:14.020058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9013df10>]}
[0m18:55:14.021593 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 data tests, 8 sources, 459 macros
[0m18:55:14.022366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd584d0>]}
[0m18:55:14.023771 [info ] [MainThread]: 
[0m18:55:14.024605 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:55:14.027716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m18:55:14.037462 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m18:55:14.037955 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m18:55:14.038250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:14.718427 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.680 seconds
[0m18:55:14.721011 [debug] [ThreadPool]: On list_dev: Close
[0m18:55:14.867370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m18:55:14.880194 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m18:55:14.881003 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m18:55:14.881583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:15.434574 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.553 seconds
[0m18:55:15.438931 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m18:55:15.562079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshots)
[0m18:55:15.565492 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshots"
[0m18:55:15.566092 [debug] [ThreadPool]: On list_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_snapshots"} */
show objects in dev.snapshots limit 10000
[0m18:55:15.566466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:16.003626 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.437 seconds
[0m18:55:16.005155 [debug] [ThreadPool]: On list_dev_snapshots: Close
[0m18:55:16.136644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd82cf0>]}
[0m18:55:16.142100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:16.146535 [info ] [MainThread]: 
[0m18:55:16.165401 [debug] [Thread-1 (]: Began running node model.elt.trip_data
[0m18:55:16.166276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshots, now model.elt.trip_data)
[0m18:55:16.166853 [debug] [Thread-1 (]: Began compiling node model.elt.trip_data
[0m18:55:16.175748 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_data"
[0m18:55:16.178511 [debug] [Thread-1 (]: Finished running node model.elt.trip_data
[0m18:55:16.180428 [debug] [Thread-1 (]: Began running node model.elt.bike_summary_table
[0m18:55:16.181318 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics.bike_summary_table ...................... [RUN]
[0m18:55:16.182305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_data, now model.elt.bike_summary_table)
[0m18:55:16.182728 [debug] [Thread-1 (]: Began compiling node model.elt.bike_summary_table
[0m18:55:16.187166 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.bike_summary_table"
[0m18:55:16.188432 [debug] [Thread-1 (]: Began executing node model.elt.bike_summary_table
[0m18:55:16.222939 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.bike_summary_table"
[0m18:55:16.224682 [debug] [Thread-1 (]: Using snowflake connection "model.elt.bike_summary_table"
[0m18:55:16.225298 [debug] [Thread-1 (]: On model.elt.bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.bike_summary_table"} */
create or replace transient table dev.analytics.bike_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    bikeid,
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    bikeid, load_timestamp
ORDER BY 
    total_trips DESC
        );
[0m18:55:16.226168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:17.762937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.535 seconds
[0m18:55:17.801335 [debug] [Thread-1 (]: On model.elt.bike_summary_table: Close
[0m18:55:17.936935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff904449b0>]}
[0m18:55:17.938500 [info ] [Thread-1 (]: 1 of 7 OK created sql table model analytics.bike_summary_table ................. [[32mSUCCESS 1[0m in 1.75s]
[0m18:55:17.941788 [debug] [Thread-1 (]: Finished running node model.elt.bike_summary_table
[0m18:55:17.942636 [debug] [Thread-1 (]: Began running node model.elt.seasonal_trip_analysis
[0m18:55:17.943806 [info ] [Thread-1 (]: 2 of 7 START sql table model analytics.seasonal_trip_analysis .................. [RUN]
[0m18:55:17.944943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.bike_summary_table, now model.elt.seasonal_trip_analysis)
[0m18:55:17.945460 [debug] [Thread-1 (]: Began compiling node model.elt.seasonal_trip_analysis
[0m18:55:17.956922 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.seasonal_trip_analysis"
[0m18:55:17.959756 [debug] [Thread-1 (]: Began executing node model.elt.seasonal_trip_analysis
[0m18:55:17.962677 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.seasonal_trip_analysis"
[0m18:55:17.964338 [debug] [Thread-1 (]: Using snowflake connection "model.elt.seasonal_trip_analysis"
[0m18:55:17.964742 [debug] [Thread-1 (]: On model.elt.seasonal_trip_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.seasonal_trip_analysis"} */
create or replace transient table dev.analytics.seasonal_trip_analysis
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN EXTRACT(MONTH, starttime) IN (12, 1, 2) THEN 'Winter (Dec-Feb)'
        WHEN EXTRACT(MONTH, starttime) IN (3, 4, 5) THEN 'Spring (Mar-May)'
        WHEN EXTRACT(MONTH, starttime) IN (6, 7, 8) THEN 'Summer (Jun-Aug)'
        WHEN EXTRACT(MONTH, starttime) IN (9, 10, 11) THEN 'Fall (Sept-Nov)'
    END AS season,
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    season, load_timestamp
        );
[0m18:55:17.965171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:20.799290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.831 seconds
[0m18:55:20.811654 [debug] [Thread-1 (]: On model.elt.seasonal_trip_analysis: Close
[0m18:55:20.989902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b104ec0>]}
[0m18:55:20.991856 [info ] [Thread-1 (]: 2 of 7 OK created sql table model analytics.seasonal_trip_analysis ............. [[32mSUCCESS 1[0m in 3.04s]
[0m18:55:20.993675 [debug] [Thread-1 (]: Finished running node model.elt.seasonal_trip_analysis
[0m18:55:20.995674 [debug] [Thread-1 (]: Began running node model.elt.station_summary
[0m18:55:20.997242 [info ] [Thread-1 (]: 3 of 7 START sql table model analytics.station_summary ......................... [RUN]
[0m18:55:20.998221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.seasonal_trip_analysis, now model.elt.station_summary)
[0m18:55:20.999450 [debug] [Thread-1 (]: Began compiling node model.elt.station_summary
[0m18:55:21.008902 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.station_summary"
[0m18:55:21.010780 [debug] [Thread-1 (]: Began executing node model.elt.station_summary
[0m18:55:21.012941 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.station_summary"
[0m18:55:21.014295 [debug] [Thread-1 (]: Using snowflake connection "model.elt.station_summary"
[0m18:55:21.014649 [debug] [Thread-1 (]: On model.elt.station_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.station_summary"} */
create or replace transient table dev.analytics.station_summary
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    start_station_id,
    start_station_name,
    COUNT(*) AS total_trips_started,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    start_station_id, start_station_name, load_timestamp
        );
[0m18:55:21.014998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:23.104901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.088 seconds
[0m18:55:23.115736 [debug] [Thread-1 (]: On model.elt.station_summary: Close
[0m18:55:23.284132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90236630>]}
[0m18:55:23.286130 [info ] [Thread-1 (]: 3 of 7 OK created sql table model analytics.station_summary .................... [[32mSUCCESS 1[0m in 2.28s]
[0m18:55:23.288694 [debug] [Thread-1 (]: Finished running node model.elt.station_summary
[0m18:55:23.289487 [debug] [Thread-1 (]: Began running node model.elt.trip_by_days_of_week
[0m18:55:23.290269 [info ] [Thread-1 (]: 4 of 7 START sql table model analytics.trip_by_days_of_week .................... [RUN]
[0m18:55:23.291128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.station_summary, now model.elt.trip_by_days_of_week)
[0m18:55:23.291559 [debug] [Thread-1 (]: Began compiling node model.elt.trip_by_days_of_week
[0m18:55:23.301783 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_by_days_of_week"
[0m18:55:23.304100 [debug] [Thread-1 (]: Began executing node model.elt.trip_by_days_of_week
[0m18:55:23.307430 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_by_days_of_week"
[0m18:55:23.309552 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_by_days_of_week"
[0m18:55:23.310298 [debug] [Thread-1 (]: On model.elt.trip_by_days_of_week: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_by_days_of_week"} */
create or replace transient table dev.analytics.trip_by_days_of_week
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    EXTRACT(DAYOFWEEK, starttime) AS day_of_week,
    COUNT(*) AS total_trips,
    load_timestamp
FROM 
    __dbt__cte__trip_data
GROUP BY 
    day_of_week, load_timestamp
ORDER BY 
    day_of_week
        );
[0m18:55:23.310887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:25.116683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.805 seconds
[0m18:55:25.121516 [debug] [Thread-1 (]: On model.elt.trip_by_days_of_week: Close
[0m18:55:25.284520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b21bfe0>]}
[0m18:55:25.290781 [info ] [Thread-1 (]: 4 of 7 OK created sql table model analytics.trip_by_days_of_week ............... [[32mSUCCESS 1[0m in 1.99s]
[0m18:55:25.294135 [debug] [Thread-1 (]: Finished running node model.elt.trip_by_days_of_week
[0m18:55:25.295899 [debug] [Thread-1 (]: Began running node model.elt.trip_duration_table
[0m18:55:25.297690 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics.trip_duration_table ..................... [RUN]
[0m18:55:25.299469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_by_days_of_week, now model.elt.trip_duration_table)
[0m18:55:25.300490 [debug] [Thread-1 (]: Began compiling node model.elt.trip_duration_table
[0m18:55:25.311010 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_duration_table"
[0m18:55:25.313415 [debug] [Thread-1 (]: Began executing node model.elt.trip_duration_table
[0m18:55:25.317117 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_duration_table"
[0m18:55:25.321569 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_duration_table"
[0m18:55:25.322251 [debug] [Thread-1 (]: On model.elt.trip_duration_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_duration_table"} */
create or replace transient table dev.analytics.trip_duration_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    CASE
        WHEN tripduration < 300 THEN '0-5 mins'
        WHEN tripduration BETWEEN 300 AND 600 THEN '5-10 mins'
        WHEN tripduration BETWEEN 600 AND 1200 THEN '10-20 mins'
        WHEN tripduration BETWEEN 1200 AND 1800 THEN '20-30 mins'
        ELSE '30+ mins'
    END AS duration_range,
    COUNT(*) AS trip_count,
    AVG(tripduration) AS avg_trip_duration,
    load_timestamp
FROM 
    __dbt__cte__trip_data 
GROUP BY 
    duration_range, load_timestamp
ORDER BY 2 DESC
        );
[0m18:55:25.322902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:27.209584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.885 seconds
[0m18:55:27.226238 [debug] [Thread-1 (]: On model.elt.trip_duration_table: Close
[0m18:55:27.371886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b138f50>]}
[0m18:55:27.375134 [info ] [Thread-1 (]: 5 of 7 OK created sql table model analytics.trip_duration_table ................ [[32mSUCCESS 1[0m in 2.07s]
[0m18:55:27.380390 [debug] [Thread-1 (]: Finished running node model.elt.trip_duration_table
[0m18:55:27.382422 [debug] [Thread-1 (]: Began running node model.elt.trip_summary_table
[0m18:55:27.384299 [info ] [Thread-1 (]: 6 of 7 START sql table model analytics.trip_summary_table ...................... [RUN]
[0m18:55:27.385770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_duration_table, now model.elt.trip_summary_table)
[0m18:55:27.386428 [debug] [Thread-1 (]: Began compiling node model.elt.trip_summary_table
[0m18:55:27.400269 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.trip_summary_table"
[0m18:55:27.402729 [debug] [Thread-1 (]: Began executing node model.elt.trip_summary_table
[0m18:55:27.406108 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.trip_summary_table"
[0m18:55:27.408144 [debug] [Thread-1 (]: Using snowflake connection "model.elt.trip_summary_table"
[0m18:55:27.408649 [debug] [Thread-1 (]: On model.elt.trip_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.trip_summary_table"} */
create or replace transient table dev.analytics.trip_summary_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COUNT(*) AS total_trips,
    AVG(tripduration) AS avg_trip_duration,
    SUM(tripduration) AS total_trip_duration,
    COUNT(DISTINCT bikeid) AS unique_bikes,
    COUNT(DISTINCT start_station_id) AS unique_start_stations,
    COUNT(DISTINCT end_station_id) AS unique_end_stations,
    COUNT(DISTINCT usertype) AS unique_user_types,
    EXTRACT(HOUR FROM starttime) AS trip_hour,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    trip_hour, load_timestamp
ORDER BY
    trip_hour
        );
[0m18:55:27.409130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:32.810483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.398 seconds
[0m18:55:32.833319 [debug] [Thread-1 (]: On model.elt.trip_summary_table: Close
[0m18:55:32.973471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b162d20>]}
[0m18:55:32.975830 [info ] [Thread-1 (]: 6 of 7 OK created sql table model analytics.trip_summary_table ................. [[32mSUCCESS 1[0m in 5.59s]
[0m18:55:32.981217 [debug] [Thread-1 (]: Finished running node model.elt.trip_summary_table
[0m18:55:32.982742 [debug] [Thread-1 (]: Began running node model.elt.user_demographic_table
[0m18:55:32.984238 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.user_demographic_table .................. [RUN]
[0m18:55:32.985319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elt.trip_summary_table, now model.elt.user_demographic_table)
[0m18:55:32.985858 [debug] [Thread-1 (]: Began compiling node model.elt.user_demographic_table
[0m18:55:33.001780 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt.user_demographic_table"
[0m18:55:33.003562 [debug] [Thread-1 (]: Began executing node model.elt.user_demographic_table
[0m18:55:33.005939 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt.user_demographic_table"
[0m18:55:33.007745 [debug] [Thread-1 (]: Using snowflake connection "model.elt.user_demographic_table"
[0m18:55:33.008141 [debug] [Thread-1 (]: On model.elt.user_demographic_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "model.elt.user_demographic_table"} */
create or replace transient table dev.analytics.user_demographic_table
         as
        (with __dbt__cte__trip_data as (
SELECT
    *
FROM dev.raw_data.trip_data
) SELECT
    COALESCE(usertype, 'Other') AS usertype,
    COUNT(*) AS trip_count,
    ROUND(AVG(birth_year)) AS avg_birth_year,
    SUM(CASE WHEN gender = 1 THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 2 THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN gender = 0 THEN 1 ELSE 0 END) AS unknown_gender_count,
    load_timestamp
FROM
    __dbt__cte__trip_data  -- Referencing the trip_data table in the raw_data schema
GROUP BY
    usertype, load_timestamp
        );
[0m18:55:33.008620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:34.616466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.608 seconds
[0m18:55:34.619484 [debug] [Thread-1 (]: On model.elt.user_demographic_table: Close
[0m18:55:34.760673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c36d1848-a1b0-43ad-b709-697b01414cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1483b0>]}
[0m18:55:34.765364 [info ] [Thread-1 (]: 7 of 7 OK created sql table model analytics.user_demographic_table ............. [[32mSUCCESS 1[0m in 1.77s]
[0m18:55:34.767810 [debug] [Thread-1 (]: Finished running node model.elt.user_demographic_table
[0m18:55:34.781452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:34.783969 [debug] [MainThread]: Connection 'model.elt.user_demographic_table' was properly closed.
[0m18:55:34.788859 [info ] [MainThread]: 
[0m18:55:34.792760 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 20.76 seconds (20.76s).
[0m18:55:34.812141 [debug] [MainThread]: Command end result
[0m18:55:34.907565 [info ] [MainThread]: 
[0m18:55:34.909316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:34.910392 [info ] [MainThread]: 
[0m18:55:34.911245 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:55:34.915213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.900509, "process_user_time": 3.789659, "process_kernel_time": 0.441739, "process_mem_max_rss": "207180", "process_out_blocks": "2000", "process_in_blocks": "0"}
[0m18:55:34.916531 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:34.916337 after 21.90 seconds
[0m18:55:34.917559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2c78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903bec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90883b00>]}
[0m18:55:34.919115 [debug] [MainThread]: Flushing usage events
[0m18:55:39.993377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84953bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a9f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a9f3b0>]}


============================== 18:55:39.997669 | 66a4010c-1d41-4280-8aa6-ad1ec6c0ae6f ==============================
[0m18:55:39.997669 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:55:39.998207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:40.583186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66a4010c-1d41-4280-8aa6-ad1ec6c0ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68083020>]}
[0m18:55:40.610241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66a4010c-1d41-4280-8aa6-ad1ec6c0ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6840f6e0>]}
[0m18:55:40.610968 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:55:40.673319 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:55:40.775550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:40.776109 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:40.818237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66a4010c-1d41-4280-8aa6-ad1ec6c0ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63f36180>]}
[0m18:55:40.902224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66a4010c-1d41-4280-8aa6-ad1ec6c0ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff639ee6f0>]}
[0m18:55:40.902679 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 data tests, 8 sources, 459 macros
[0m18:55:40.902973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66a4010c-1d41-4280-8aa6-ad1ec6c0ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63bc2ea0>]}
[0m18:55:40.904376 [info ] [MainThread]: 
[0m18:55:40.904924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:55:40.907919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshots'
[0m18:55:40.918019 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshots"
[0m18:55:40.918603 [debug] [ThreadPool]: On list_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_snapshots"} */
show objects in dev.snapshots limit 10000
[0m18:55:40.918959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:41.554729 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.635 seconds
[0m18:55:41.563735 [debug] [ThreadPool]: On list_dev_snapshots: Close
[0m18:55:41.718160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshots, now list_dev_analytics)
[0m18:55:41.723788 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m18:55:41.724554 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m18:55:41.725244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:42.238502 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.513 seconds
[0m18:55:42.242269 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m18:55:42.407171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66a4010c-1d41-4280-8aa6-ad1ec6c0ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63c5f3b0>]}
[0m18:55:42.409289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:42.410568 [info ] [MainThread]: 
[0m18:55:42.431412 [debug] [Thread-1 (]: Began running node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m18:55:42.432334 [info ] [Thread-1 (]: 1 of 2 START test not_null_bike_summary_table_bikeId ........................... [RUN]
[0m18:55:42.433127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.elt.not_null_bike_summary_table_bikeId.2cb1291f50)
[0m18:55:42.433681 [debug] [Thread-1 (]: Began compiling node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m18:55:42.455043 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"
[0m18:55:42.456862 [debug] [Thread-1 (]: Began executing node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m18:55:42.471854 [debug] [Thread-1 (]: Writing runtime sql for node "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"
[0m18:55:42.473909 [debug] [Thread-1 (]: Using snowflake connection "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"
[0m18:55:42.474306 [debug] [Thread-1 (]: On test.elt.not_null_bike_summary_table_bikeId.2cb1291f50: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "test.elt.not_null_bike_summary_table_bikeId.2cb1291f50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select bikeId
from dev.analytics.bike_summary_table
where bikeId is null



      
    ) dbt_internal_test
[0m18:55:42.474593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:42.996628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m18:55:43.017381 [debug] [Thread-1 (]: On test.elt.not_null_bike_summary_table_bikeId.2cb1291f50: Close
[0m18:55:43.155064 [info ] [Thread-1 (]: 1 of 2 PASS not_null_bike_summary_table_bikeId ................................. [[32mPASS[0m in 0.72s]
[0m18:55:43.157453 [debug] [Thread-1 (]: Finished running node test.elt.not_null_bike_summary_table_bikeId.2cb1291f50
[0m18:55:43.158492 [debug] [Thread-1 (]: Began running node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m18:55:43.159702 [info ] [Thread-1 (]: 2 of 2 START test unique_bike_summary_table_bikeId ............................. [RUN]
[0m18:55:43.160778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.elt.not_null_bike_summary_table_bikeId.2cb1291f50, now test.elt.unique_bike_summary_table_bikeId.47dbef4e35)
[0m18:55:43.161581 [debug] [Thread-1 (]: Began compiling node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m18:55:43.175653 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"
[0m18:55:43.180890 [debug] [Thread-1 (]: Began executing node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m18:55:43.187605 [debug] [Thread-1 (]: Writing runtime sql for node "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"
[0m18:55:43.190189 [debug] [Thread-1 (]: Using snowflake connection "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"
[0m18:55:43.190847 [debug] [Thread-1 (]: On test.elt.unique_bike_summary_table_bikeId.47dbef4e35: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "test.elt.unique_bike_summary_table_bikeId.47dbef4e35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    bikeId as unique_field,
    count(*) as n_records

from dev.analytics.bike_summary_table
where bikeId is not null
group by bikeId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:55:43.191390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:43.951326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m18:55:43.958633 [debug] [Thread-1 (]: On test.elt.unique_bike_summary_table_bikeId.47dbef4e35: Close
[0m18:55:44.121613 [info ] [Thread-1 (]: 2 of 2 PASS unique_bike_summary_table_bikeId ................................... [[32mPASS[0m in 0.96s]
[0m18:55:44.123182 [debug] [Thread-1 (]: Finished running node test.elt.unique_bike_summary_table_bikeId.47dbef4e35
[0m18:55:44.126017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:44.131215 [debug] [MainThread]: Connection 'test.elt.unique_bike_summary_table_bikeId.47dbef4e35' was properly closed.
[0m18:55:44.132051 [info ] [MainThread]: 
[0m18:55:44.132642 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m18:55:44.134020 [debug] [MainThread]: Command end result
[0m18:55:44.192113 [info ] [MainThread]: 
[0m18:55:44.192940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:44.193405 [info ] [MainThread]: 
[0m18:55:44.194166 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:55:44.204626 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.261836, "process_user_time": 3.042138, "process_kernel_time": 0.3553, "process_mem_max_rss": "206352", "process_out_blocks": "1939", "process_in_blocks": "0"}
[0m18:55:44.207184 [debug] [MainThread]: Command `dbt test` succeeded at 18:55:44.206545 after 4.27 seconds
[0m18:55:44.211445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84953bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b6b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a9f290>]}
[0m18:55:44.214610 [debug] [MainThread]: Flushing usage events
[0m18:55:48.434482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10c4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0aff740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10c4830>]}


============================== 18:55:48.438924 | 6542bc86-413d-4903-ab30-b665a98bcf41 ==============================
[0m18:55:48.438924 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:55:48.443129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:49.121319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6542bc86-413d-4903-ab30-b665a98bcf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ae3c20>]}
[0m18:55:49.146992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6542bc86-413d-4903-ab30-b665a98bcf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1947ad0>]}
[0m18:55:49.147617 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:55:49.216471 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:55:49.320160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:49.320514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:49.345945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6542bc86-413d-4903-ab30-b665a98bcf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94946ed0>]}
[0m18:55:49.412276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6542bc86-413d-4903-ab30-b665a98bcf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94672de0>]}
[0m18:55:49.412677 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 data tests, 8 sources, 459 macros
[0m18:55:49.413224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6542bc86-413d-4903-ab30-b665a98bcf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a86300>]}
[0m18:55:49.414539 [info ] [MainThread]: 
[0m18:55:49.415211 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:55:49.415862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m18:55:49.423881 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m18:55:49.424187 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m18:55:49.424461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:50.047470 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.622 seconds
[0m18:55:50.054557 [debug] [ThreadPool]: On list_dev: Close
[0m18:55:50.208176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m18:55:50.250634 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m18:55:50.252021 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m18:55:50.253171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:50.759961 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.507 seconds
[0m18:55:50.772792 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m18:55:50.918859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshots)
[0m18:55:50.926394 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshots"
[0m18:55:50.927264 [debug] [ThreadPool]: On list_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "connection_name": "list_dev_snapshots"} */
show objects in dev.snapshots limit 10000
[0m18:55:50.927940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:51.366418 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.438 seconds
[0m18:55:51.370331 [debug] [ThreadPool]: On list_dev_snapshots: Close
[0m18:55:51.528785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6542bc86-413d-4903-ab30-b665a98bcf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946ed310>]}
[0m18:55:51.530461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:51.534579 [info ] [MainThread]: 
[0m18:55:51.545604 [debug] [Thread-1 (]: Began running node snapshot.elt.snapshot_bike_summary_table
[0m18:55:51.546495 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_bike_summary_table .................... [RUN]
[0m18:55:51.548346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshots, now snapshot.elt.snapshot_bike_summary_table)
[0m18:55:51.549624 [debug] [Thread-1 (]: Began compiling node snapshot.elt.snapshot_bike_summary_table
[0m18:55:51.557111 [debug] [Thread-1 (]: Began executing node snapshot.elt.snapshot_bike_summary_table
[0m18:55:51.611978 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:55:51.612843 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(bikeId as varchar ), '')
         || '|' || coalesce(cast(load_timestamp as varchar ), '')
        ) as dbt_scd_id,
        load_timestamp as dbt_updated_at,
        load_timestamp as dbt_valid_from,
        
  
  coalesce(nullif(load_timestamp, load_timestamp), null)
  as dbt_valid_to

    from (
        

  

SELECT * FROM dev.analytics.bike_summary_table

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:55:51.613545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:52.160425 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.546 seconds
[0m18:55:52.170174 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:55:52.170930 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:55:52.299154 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.127 seconds
[0m18:55:52.300956 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.elt.snapshot_bike_summary_table"
[0m18:55:52.306285 [debug] [Thread-1 (]: Using snowflake connection "snapshot.elt.snapshot_bike_summary_table"
[0m18:55:52.307279 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "elt", "target_name": "dev", "node_id": "snapshot.elt.snapshot_bike_summary_table"} */
create or replace transient table dev.snapshots.snapshot_bike_summary_table
         as
        (
    

    select *,
        md5(coalesce(cast(bikeId as varchar ), '')
         || '|' || coalesce(cast(load_timestamp as varchar ), '')
        ) as dbt_scd_id,
        load_timestamp as dbt_updated_at,
        load_timestamp as dbt_valid_from,
        
  
  coalesce(nullif(load_timestamp, load_timestamp), null)
  as dbt_valid_to

    from (
        

  

SELECT * FROM dev.analytics.bike_summary_table

    ) sbq



        );
[0m18:55:53.159535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m18:55:53.206067 [debug] [Thread-1 (]: On snapshot.elt.snapshot_bike_summary_table: Close
[0m18:55:53.329687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6542bc86-413d-4903-ab30-b665a98bcf41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c943b0>]}
[0m18:55:53.331705 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_bike_summary_table .................... [[32mSUCCESS 1[0m in 1.78s]
[0m18:55:53.333694 [debug] [Thread-1 (]: Finished running node snapshot.elt.snapshot_bike_summary_table
[0m18:55:53.337392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:53.337944 [debug] [MainThread]: Connection 'snapshot.elt.snapshot_bike_summary_table' was properly closed.
[0m18:55:53.338530 [info ] [MainThread]: 
[0m18:55:53.339600 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m18:55:53.341123 [debug] [MainThread]: Command end result
[0m18:55:53.383678 [info ] [MainThread]: 
[0m18:55:53.384552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:53.385018 [info ] [MainThread]: 
[0m18:55:53.385576 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:55:53.388393 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.0199084, "process_user_time": 3.106088, "process_kernel_time": 0.450687, "process_mem_max_rss": "207172", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m18:55:53.389242 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:55:53.389154 after 5.02 seconds
[0m18:55:53.389783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10c4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f01550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e5e5a0>]}
[0m18:55:53.390159 [debug] [MainThread]: Flushing usage events
